<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">



  
  
  <link rel="stylesheet" href="/lib/Han/dist/han.min.css?v=3.3">



  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">











  
  
  <link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css">







<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/cat_32px_1165145_easyicon.net.ico?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/cat_16px_1165145_easyicon.net.ico?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '5HERDWLKZV',
      apiKey: '7876dff207d78e6df0721656b26ee0af',
      indexName: 'hexo-algolia',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="端对端1V1传输基本流程媒体能力协商过程WebRTC 端对端连接： RTCPeerConnection：  基本格式 1pc = new RTCPeerConnection([configuration]);">
<meta name="keywords" content="WebRTC">
<meta property="og:type" content="article">
<meta property="og:title" content="WebRTC（二）">
<meta property="og:url" content="http://miaopei.github.io/2019/05/15/WebRTC/webrtc-02/index.html">
<meta property="og:site_name" content="Mr.Miaow Blog">
<meta property="og:description" content="端对端1V1传输基本流程媒体能力协商过程WebRTC 端对端连接： RTCPeerConnection：  基本格式 1pc = new RTCPeerConnection([configuration]);">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/媒体协商过程.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/协商状态变化.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/addTrackParameters.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/端对端连接的基本流程.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SessionDescription.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/TimeDescription.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/MediaDescription.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-02.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-03.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-04.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-05.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-06.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/字段含义-07.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/WebRTC中的SDP.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/STUNTURN服务器选型.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/coTurn服务器搭建与部署.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/coTurn服务器配置.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/测试turn服务.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPeerConnection-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Configurations-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Configurations-02.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Configurations-03.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Configurations-04.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/addIceCandidate.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/直播系统消息处理流程.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/createOffer.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/客户端状态机.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/客户端流程图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/客户端流程图-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/端对端连接的基本流程.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/注意要点.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/getDisplayMedia-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/需要注意的点.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Receiver和Sender.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCRtpSender属性.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCRtpReceiver.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCRtpSender.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTPMedia.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCRtpTransceiver.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTPMedia-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/chromeWebRTC-internals.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/createDataChannel.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/option-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/option-02.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/使用Options.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/DataChannel事件.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/创建RTCDataChannel.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/非音视频数据传输方式.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/知识点.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/协议栈.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/传输协议.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTP协议.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTP字段说明.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCP包.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPPayloadType.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPHeader.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPHeader说明.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPSenderReport.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SenderInfomationBlock.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SenderInfo说明.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/ReportBlock.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/ReceiveReportBlock.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPReceiverReport.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPSR-RR发送时机.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPSDES.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SDESitem.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SDES说明.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPBYE.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPAPP.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPAPP字段说明.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/DTLS.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/SRTP.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/主要内容.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/需要权限.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Android权限管理.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/引入库.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/信令处理.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/AndroidSocketio.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/socketio接收消息.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/结构图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/呼叫端时序图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/被叫端时序图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/关闭时序图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/webrtc处理流程.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/重要类-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/重要类-02.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/两个观察者.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/权限库界面.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/收发信令.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/主要内容-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/主要内容-02.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/引入WebRTC库的方式.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/引入WebRTC库.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/Podfile.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/socketio的使用.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/连接服务器.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/发送消息.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/注册侦听消息.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/媒体协商.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/信令时序图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/RTCPeerConnection委托.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/小结.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/信令服务器.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/JS客户端实现.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/JS客户端实现-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/进阶.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/进阶-01.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/行业痛点.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/webrtc分层协议图.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/信令会话协议.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/supplement/1V1%E4%BA%92%E5%8A%A8%E7%9B%B4%E6%92%AD%E9%80%9A%E8%AE%AF%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/supplement/TIM-01.jpg">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/supplement/TIM-02.jpg">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/supplement/WebRTC-ICECandidateExchange.svg">
<meta property="og:image" content="http://miaopei.github.io/images/imageWebRTC/supplement/WebRTC-SignalingDiagram.svg">
<meta property="og:updated_time" content="2019-07-31T07:25:51.789Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WebRTC（二）">
<meta name="twitter:description" content="端对端1V1传输基本流程媒体能力协商过程WebRTC 端对端连接： RTCPeerConnection：  基本格式 1pc = new RTCPeerConnection([configuration]);">
<meta name="twitter:image" content="http://miaopei.github.io/images/imageWebRTC/媒体协商过程.png">



  <link rel="alternate" href="/atom.xml" title="Mr.Miaow Blog" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://miaopei.github.io/2019/05/15/WebRTC/webrtc-02/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>WebRTC（二） | Mr.Miaow Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr.Miaow Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Do what you say, say what you do.</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://miaopei.github.io/2019/05/15/WebRTC/webrtc-02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Miaow">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://wx4.sinaimg.cn/orj360/e9d04169ly1fde7jy4bquj20ek0hf7gh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Miaow Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">WebRTC（二）

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-15 10:14:50" itemprop="dateCreated datePublished" datetime="2019-05-15T10:14:50+08:00">2019-05-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-07-31 15:25:51" itemprop="dateModified" datetime="2019-07-31T15:25:51+08:00">2019-07-31</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/WebRTC/" itemprop="url" rel="index"><span itemprop="name">WebRTC</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">12.5k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">57</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <h2 id="端对端1V1传输基本流程"><a href="#端对端1V1传输基本流程" class="headerlink" title="端对端1V1传输基本流程"></a>端对端1V1传输基本流程</h2><h3 id="媒体能力协商过程"><a href="#媒体能力协商过程" class="headerlink" title="媒体能力协商过程"></a>媒体能力协商过程</h3><p>WebRTC 端对端连接：</p>
<p><strong>RTCPeerConnection</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pc = <span class="keyword">new</span> RTCPeerConnection([configuration]);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<a id="more"></a>

<p><strong>RTCPeerConnection 方法分类</strong>：</p>
<ul>
<li>媒体协商</li>
<li>Stream/Track</li>
<li>传输相关方法</li>
<li>统计相关方法</li>
</ul>
<img src="/images/imageWebRTC/媒体协商过程.png">

<img src="/images/imageWebRTC/协商状态变化.png">

<p><strong>媒体协商方法</strong>：</p>
<ul>
<li>createOffer</li>
<li>createAnswer</li>
<li>setLocakDescription</li>
<li>setRemoteDescription</li>
</ul>
<p><strong>createOffer</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aPromise = myPeerConnection.createOffer([options]);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>createAnswer</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aPromise = myPeerConnection.createAnswer([options]);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>setLocakDescription</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aPromise = myPc.setLocalDescription(sessionDescription);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>setRemoteDescription</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aPromise = myPc.setRemoteDescription(sessionDescription);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>Track 方法</strong>：</p>
<ul>
<li>addTrack</li>
<li>removeTrack</li>
</ul>
<p><strong>addTrack</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rtpSender = myPc.addTrack(track, stream...);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Parameters</p>
<img src="/images/imageWebRTC/addTrackParameters.png">

</li>
</ul>
<p><strong>removeTrack</strong>：</p>
<ul>
<li><p>基本格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myPc.remoteTrack(rtpSender);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>重要事件</strong>：</p>
<ul>
<li>onnegotiationneeded  - 协商的时候触发这个事件</li>
<li>onicecandidate - 当收到 ICE 候选者的时候触发这个事件</li>
</ul>
<h3 id="1-1-连接的基本流程"><a href="#1-1-连接的基本流程" class="headerlink" title="1:1 连接的基本流程"></a>1:1 连接的基本流程</h3><img src="/images/imageWebRTC/端对端连接的基本流程.png">

<p><strong>A 与 B 通信，大的方向分为三部分</strong>：</p>
<ul>
<li>媒体协商部分</li>
<li>ICE 候选者的交换、连接、检测部分</li>
<li>媒体数据流的通信部分</li>
</ul>
<h3 id="【实战】WebRTC-视频传输"><a href="#【实战】WebRTC-视频传输" class="headerlink" title="【实战】WebRTC 视频传输"></a>【实战】WebRTC 视频传输</h3><p>TODO</p>
<h3 id="【实战】显示通讯双方的-SDP-内容"><a href="#【实战】显示通讯双方的-SDP-内容" class="headerlink" title="【实战】显示通讯双方的 SDP 内容"></a>【实战】显示通讯双方的 SDP 内容</h3><p>TODO</p>
<h2 id="WebRTC核心之SDP详解"><a href="#WebRTC核心之SDP详解" class="headerlink" title="WebRTC核心之SDP详解"></a>WebRTC核心之SDP详解</h2><h3 id="【协议规范】SDP-规范"><a href="#【协议规范】SDP-规范" class="headerlink" title="【协议规范】SDP 规范"></a>【协议规范】SDP 规范</h3><p><strong>SDP 规范</strong>：</p>
<ul>
<li>会话层</li>
<li>媒体层</li>
</ul>
<p>可以把会话层看做树根，媒体层看成树干。</p>
<p><strong>会话层</strong>：</p>
<ul>
<li>会话的名称与目的</li>
<li>会话的存活时间</li>
<li>会话中包含多个媒体信息</li>
</ul>
<p><strong>SDP 媒体信息</strong>：</p>
<ul>
<li>媒体格式</li>
<li>传输协议</li>
<li>传输 IP 和 端口</li>
<li>媒体负载类型</li>
</ul>
<p><strong>SDP 格式</strong>：</p>
<ul>
<li>由多个 <code>&lt;type&gt;=&lt;value&gt;</code> 组成</li>
<li>一个会话级描述</li>
<li>多个媒体级描述</li>
</ul>
<p><strong>SDP 结构</strong>：</p>
<ul>
<li>Session Description</li>
<li>Time Description</li>
<li>Media Description</li>
</ul>
<img src="/images/imageWebRTC/SessionDescription.png">

<img src="/images/imageWebRTC/TimeDescription.png">

<img src="/images/imageWebRTC/MediaDescription.png">

<img src="/images/imageWebRTC/字段含义-01.png">

<img src="/images/imageWebRTC/字段含义-02.png">

<img src="/images/imageWebRTC/字段含义-03.png">

<img src="/images/imageWebRTC/字段含义-04.png">

<img src="/images/imageWebRTC/字段含义-05.png">

<img src="/images/imageWebRTC/字段含义-06.png">

<img src="/images/imageWebRTC/字段含义-07.png">

<h3 id="【协议规范】WebRTC-中的-SDP"><a href="#【协议规范】WebRTC-中的-SDP" class="headerlink" title="【协议规范】WebRTC 中的 SDP"></a>【协议规范】WebRTC 中的 SDP</h3><img src="/images/imageWebRTC/WebRTC中的SDP.png">

<h3 id="【详解】WebRTC-中-Offer-Answer-SDP"><a href="#【详解】WebRTC-中-Offer-Answer-SDP" class="headerlink" title="【详解】WebRTC 中 Offer_Answer SDP"></a>【详解】WebRTC 中 Offer_Answer SDP</h3><details><summary>SDP报文内容</summary>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">v=0</span><br><span class="line">o=- 2584450093346841581 2 IN IP4 127.0.0.1</span><br><span class="line">s=-</span><br><span class="line">t=0 0</span><br><span class="line">a=group:BUNDLE audio video data</span><br><span class="line">a=msid-semantic: WMS 616cfbb1-33a3-4d8c-8275-a199d6005549</span><br><span class="line">m=audio 9 UDP/TLS/RTP/SAVPF 111 103 104 9 0 8 106 105 13 110 112 113 126</span><br><span class="line">c=IN IP4 0.0.0.0 </span><br><span class="line">a=rtcp:9 IN IP4 0.0.0.0</span><br><span class="line">a=ice-ufrag:sXJ3</span><br><span class="line">a=ice-pwd:yEclOTrLg1gEubBFefOqtmyV</span><br><span class="line">a=fingerprint:sha-256 22:14:B5:AF:66:12:C7:C7:8D:EF:4B:DE:40:25:ED:5D:8F:17:54:DD:88:33:C0:13:2E:FD:1A:FA:7E:7A:1B:79</span><br><span class="line">a=setup:actpass</span><br><span class="line">a=mid:audio</span><br><span class="line">a=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level</span><br><span class="line">a=sendrecv</span><br><span class="line">a=rtcp-mux</span><br><span class="line">a=rtpmap:111 opus/48000/2</span><br><span class="line">a=rtcp-fb:111 transport-cc</span><br><span class="line">a=fmtp:111 minptime=10;useinbandfec=1</span><br><span class="line">a=rtpmap:103 ISAC/16000</span><br><span class="line">a=rtpmap:104 ISAC/32000</span><br><span class="line">a=rtpmap:9 G722/8000</span><br><span class="line">a=rtpmap:0 PCMU/8000</span><br><span class="line">a=rtpmap:8 PCMA/8000</span><br><span class="line">a=rtpmap:106 CN/32000</span><br><span class="line">a=rtpmap:105 CN/16000</span><br><span class="line">a=rtpmap:13 CN/8000</span><br><span class="line">a=rtpmap:110 telephone-event/48000</span><br><span class="line">a=rtpmap:112 telephone-event/32000</span><br><span class="line">a=rtpmap:113 telephone-event/16000</span><br><span class="line">a=rtpmap:126 telephone-event/8000</span><br><span class="line">a=ssrc:120276603 cname:iSkJ2vn5cYYubTve</span><br><span class="line">a=ssrc:120276603 msid:616cfbb1-33a3-4d8c-8275-a199d6005549 1da3d329-7399-4fe9-b20f-69606bebd363</span><br><span class="line">a=ssrc:120276603 mslabel:616cfbb1-33a3-4d8c-8275-a199d6005549</span><br><span class="line">a=ssrc:120276603 label:1da3d329-7399-4fe9-b20f-69606bebd363</span><br><span class="line">m=video 9 UDP/TLS/RTP/SAVPF 96 98 100 102 127 97 99 101 125</span><br><span class="line">c=IN IP4 0.0.0.0</span><br><span class="line">a=rtcp:9 IN IP4 0.0.0.0</span><br><span class="line">a=ice-ufrag:sXJ3</span><br><span class="line">a=ice-pwd:yEclOTrLg1gEubBFefOqtmyV</span><br><span class="line">a=fingerprint:sha-256 22:14:B5:AF:66:12:C7:C7:8D:EF:4B:DE:40:25:ED:5D:8F:17:54:DD:88:33:C0:13:2E:FD:1A:FA:7E:7A:1B:79</span><br><span class="line">a=setup:actpass</span><br><span class="line">a=mid:video</span><br><span class="line">a=extmap:2 urn:ietf:params:rtp-hdrext:toffset</span><br><span class="line">a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time</span><br><span class="line">a=extmap:4 urn:3gpp:video-orientation</span><br><span class="line">a=extmap:5 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01</span><br><span class="line">a=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay</span><br><span class="line">a=sendrecv</span><br><span class="line">a=rtcp-mux</span><br><span class="line">a=rtcp-rsize</span><br><span class="line">a=rtpmap:96 VP8/90000</span><br><span class="line">a=rtcp-fb:96 ccm fir</span><br><span class="line">a=rtcp-fb:96 nack</span><br><span class="line">a=rtcp-fb:96 nack pli</span><br><span class="line">a=rtcp-fb:96 goog-remb</span><br><span class="line">a=rtcp-fb:96 transport-cc</span><br><span class="line">a=rtpmap:97 rtx/90000</span><br><span class="line">a=fmtp:97 apt=96</span><br><span class="line">a=rtpmap:98 VP9/90000</span><br><span class="line">a=rtcp-fb:98 ccm fir</span><br><span class="line">a=rtcp-fb:98 nack</span><br><span class="line">a=rtcp-fb:98 nack pli</span><br><span class="line">a=rtcp-fb:98 goog-remb</span><br><span class="line">a=rtcp-fb:98 transport-cc</span><br><span class="line">a=rtpmap:100 H264/90000</span><br><span class="line">a=rtcp-fb:100 ccm fir</span><br><span class="line">a=rtcp-fb:100 nack</span><br><span class="line">a=rtcp-fb:100 nack pli</span><br><span class="line">a=rtcp-fb:100 goog-remb</span><br><span class="line">a=rtcp-fb:100 transport-cc</span><br><span class="line">a=fmtp:100 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f</span><br><span class="line">a=rtpmap:102 red/90000</span><br><span class="line">a=rtpmap:127 ulpfec/90000</span><br><span class="line">a=rtpmap:97 rtx/90000</span><br><span class="line">a=fmtp:97 apt=96</span><br><span class="line">a=rtpmap:99 rtx/90000</span><br><span class="line">a=fmtp:99 apt=98</span><br><span class="line">a=rtpmap:101 rtx/90000</span><br><span class="line">a=fmtp:101 apt=100</span><br><span class="line">a=rtpmap:125 rtx/90000</span><br><span class="line">a=fmtp:125 apt=102</span><br><span class="line">a=ssrc-group:FID 2580761338 611523443</span><br><span class="line">a=ssrc:2580761338 cname:iSkJ2vn5cYYubTve</span><br><span class="line">a=ssrc:2580761338 msid:616cfbb1-33a3-4d8c-8275-a199d6005549 bf270496-a23e-47b5-b901-ef23096cd961</span><br><span class="line">a=ssrc:2580761338 mslabel:616cfbb1-33a3-4d8c-8275-a199d6005549</span><br><span class="line">a=ssrc:2580761338 label:bf270496-a23e-47b5-b901-ef23096cd961</span><br><span class="line">a=ssrc:611523443 cname:iSkJ2vn5cYYubTve</span><br><span class="line">a=ssrc:611523443 msid:616cfbb1-33a3-4d8c-8275-a199d6005549 bf270496-a23e-47b5-b901-ef23096cd961</span><br><span class="line">a=ssrc:611523443 mslabel:616cfbb1-33a3-4d8c-8275-a199d6005549</span><br><span class="line">a=ssrc:611523443 label:bf270496-a23e-47b5-b901-ef23096cd961</span><br><span class="line">m=application 9 DTLS/SCTP 5000</span><br><span class="line">c=IN IP4 0.0.0.0</span><br><span class="line">a=ice-ufrag:sXJ3</span><br><span class="line">a=ice-pwd:yEclOTrLg1gEubBFefOqtmyV</span><br><span class="line">a=fingerprint:sha-256 22:14:B5:AF:66:12:C7:C7:8D:EF:4B:DE:40:25:ED:5D:8F:17:54:DD:88:33:C0:13:2E:FD:1A:FA:7E:7A:1B:79</span><br><span class="line">a=setup:actpass</span><br><span class="line">a=mid:data</span><br><span class="line">a=sctpmap:5000 webrtc-datachannel 1024</span><br></pre></td></tr></table></figure>

</details>

<h2 id="实现1V1音视频实时互动直播系统"><a href="#实现1V1音视频实时互动直播系统" class="headerlink" title="实现1V1音视频实时互动直播系统"></a>实现1V1音视频实时互动直播系统</h2><h3 id="STUN-TURN-服务器搭建"><a href="#STUN-TURN-服务器搭建" class="headerlink" title="STUN/TURN 服务器搭建"></a>STUN/TURN 服务器搭建</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZpcmVyb2xsL2FydGljbGUvZGV0YWlscy81MDc4MDg2Mw==" title="https://blog.csdn.net/fireroll/article/details/50780863">webrtc进阶-信令篇-之三：信令、stun、turn、ice<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xhbWI3NzU4L2FydGljbGUvZGV0YWlscy83NzA0NTczNQ==" title="https://blog.csdn.net/lamb7758/article/details/77045735">webRTC+coturn穿透服务器的安装与搭建<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9teS5vc2NoaW5hLm5ldC9hbmR5d2FuZzE5ODgvYmxvZy84NDg2NDU=" title="https://my.oschina.net/andywang1988/blog/848645">WebRTC的信令服务器Collider和Turn服务器搭建<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9hMTk0NDEwMzRmMTc=" title="https://www.jianshu.com/p/a19441034f17">AppRTC(WebRTC)服务器搭建<i class="fa fa-external-link"></i></span></p>
</blockquote>
<p>coTurn Download Address：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NvdHVybi9jb3R1cm4=" title="https://github.com/coturn/coturn">https://github.com/coturn/coturn<i class="fa fa-external-link"></i></span></p>
<p>ICE 测试地址：<span class="exturl" data-url="aHR0cHM6Ly93ZWJydGMuZ2l0aHViLmlvL3NhbXBsZXM=" title="https://webrtc.github.io/samples">https://webrtc.github.io/samples<i class="fa fa-external-link"></i></span></p>
<p>coturn 编译安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/coturn/coturn </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> coturn </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ./configure </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make install</span></span><br></pre></td></tr></table></figure>

<p>安装sqlite</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo atp-get install sqlite</span></span><br></pre></td></tr></table></figure>

<p>生成认证用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> turnadmin -A –u 用户名 -r beijing -p 密码 </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> turnadmin -a –u 用户名 -r beijing -p 密码 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> A 是添加管理员</span></span><br></pre></td></tr></table></figure>

<p>然后生成md5码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> turnadmin -k –u 用户名 -r beijing -p 密码</span></span><br></pre></td></tr></table></figure>

<p>生成证书</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl req -x509 -newkey rsa:2048 -keyout /etc/turn_server_pkey.pem -out /etc/turn_server_cert.pem -days 99999 -nodes </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 一路回车就好</span></span><br></pre></td></tr></table></figure>

<p>创建配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> vi /usr/<span class="built_in">local</span>/etc/turnserver.conf </span></span><br><span class="line">listening-device=eth1 </span><br><span class="line">relay-device=eth1 </span><br><span class="line">listening-port=3478 </span><br><span class="line">listening-ip=YOU_IP </span><br><span class="line">listening-ip=YOU_IP2 </span><br><span class="line"><span class="meta">#</span><span class="bash"> (stun 需要两个公网ip，只有一个公网ip只能作文turn服务器) </span></span><br><span class="line">tls-listening-port=5349 </span><br><span class="line">lt-cred-mech </span><br><span class="line">min-port=59000 </span><br><span class="line">max-port=65000 </span><br><span class="line">realm=beijing </span><br><span class="line">no-loopback-peers </span><br><span class="line">no-multicast-peers </span><br><span class="line">mobility </span><br><span class="line">no-cli </span><br><span class="line">cert=/etc/turn_server_cert.pem </span><br><span class="line">pkey=/etc/turn_server_pkey.pem </span><br><span class="line">fingerprint </span><br><span class="line">stale-nonce=600</span><br></pre></td></tr></table></figure>

<p>启动 coturn</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 turn server</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> turnserver -c /usr/<span class="built_in">local</span>/coturn/etc/turnserver.conf</span></span><br></pre></td></tr></table></figure>

<img src="/images/imageWebRTC/STUNTURN服务器选型.png">

<img src="/images/imageWebRTC/coTurn服务器搭建与部署.png">

<img src="/images/imageWebRTC/coTurn服务器配置.png">

<img src="/images/imageWebRTC/测试turn服务.png">

<h3 id="【参数介绍】再论-RTCPeerConnection"><a href="#【参数介绍】再论-RTCPeerConnection" class="headerlink" title="【参数介绍】再论 RTCPeerConnection"></a>【参数介绍】再论 RTCPeerConnection</h3><img src="/images/imageWebRTC/RTCPeerConnection-01.png">

<img src="/images/imageWebRTC/Configurations-01.png">

<img src="/images/imageWebRTC/Configurations-02.png">

<img src="/images/imageWebRTC/Configurations-03.png">

<img src="/images/imageWebRTC/Configurations-04.png">

<img src="/images/imageWebRTC/addIceCandidate.png">

<h3 id="直播系统中的信令及其逻辑关系"><a href="#直播系统中的信令及其逻辑关系" class="headerlink" title="直播系统中的信令及其逻辑关系"></a>直播系统中的信令及其逻辑关系</h3><p>【实战】真正的音视频传输</p>
<p><strong>客户端信令消息</strong>：</p>
<ul>
<li>join 加入房间</li>
<li>leave 离开房间</li>
<li>message 端到端消息</li>
</ul>
<p><strong>端到端信令消息</strong>：</p>
<ul>
<li>Offer 消息</li>
<li>Answer 消息</li>
<li>Candidate 消息</li>
</ul>
<p><strong>服务端信令消息</strong>：</p>
<ul>
<li>joined 已加入房间</li>
<li>otherjoin 其它用户加入房间</li>
<li>full 房间人数已满</li>
<li>leaved 已离开房间</li>
<li>bye 对方离开房间</li>
</ul>
<img src="/images/imageWebRTC/直播系统消息处理流程.png">

<h3 id="实现-1：1-音视频实时互动信令服务器"><a href="#实现-1：1-音视频实时互动信令服务器" class="headerlink" title="实现 1：1 音视频实时互动信令服务器"></a>实现 1：1 音视频实时互动信令服务器</h3><p>信令服务器改造</p>
<p>TODO</p>
<h3 id="再论CreateOffer"><a href="#再论CreateOffer" class="headerlink" title="再论CreateOffer"></a>再论CreateOffer</h3><img src="/images/imageWebRTC/createOffer.png">

<p><strong>CreateOffer 实战</strong>：</p>
<ul>
<li>接收远端音频</li>
<li>接收远端视频</li>
<li>静音检测</li>
<li>ICE restart</li>
</ul>
<h3 id="WebRTC-客户端状态机及处理逻辑"><a href="#WebRTC-客户端状态机及处理逻辑" class="headerlink" title="WebRTC 客户端状态机及处理逻辑"></a>WebRTC 客户端状态机及处理逻辑</h3><p>直播客户端的实现：</p>
<img src="/images/imageWebRTC/客户端状态机.png">

<img src="/images/imageWebRTC/客户端流程图.png">

<img src="/images/imageWebRTC/客户端流程图-01.png">

<img src="/images/imageWebRTC/端对端连接的基本流程.png">

<h3 id="WebRTC-客户端的实现"><a href="#WebRTC-客户端的实现" class="headerlink" title="WebRTC 客户端的实现"></a>WebRTC 客户端的实现</h3><img src="/images/imageWebRTC/注意要点.png">

<h3 id="共享远程桌面"><a href="#共享远程桌面" class="headerlink" title="共享远程桌面"></a>共享远程桌面</h3><img src="/images/imageWebRTC/getDisplayMedia-01.png">

<img src="/images/imageWebRTC/需要注意的点.png">

<h2 id="WebRTC核心之RTP媒体控制与数据统计"><a href="#WebRTC核心之RTP媒体控制与数据统计" class="headerlink" title="WebRTC核心之RTP媒体控制与数据统计"></a>WebRTC核心之RTP媒体控制与数据统计</h2><h3 id="RTPPReceiver-发送器"><a href="#RTPPReceiver-发送器" class="headerlink" title="RTPPReceiver 发送器"></a>RTPPReceiver 发送器</h3><p>RTP Media 里边两个重要的类：Receiver 和 Sender</p>
<img src="/images/imageWebRTC/Receiver和Sender.png">

<p>Receiver 和 Sender 共有的三个属性</p>
<img src="/images/imageWebRTC/RTCRtpSender属性.png">

<img src="/images/imageWebRTC/RTCRtpReceiver.png">

<ul>
<li>getParameters  - 编解码器相关参数</li>
<li>getSynchronizationSources - 获取共享源（同步源），每一个媒体流都一个唯一的共享源</li>
<li>getContributingSources - 贡献来源，最主要用于混音和混频的情况</li>
<li>getStats - 获取统计信息</li>
<li>getCapabilities - 获取协商后的媒体能力</li>
</ul>
<h3 id="RTPSender-发送器"><a href="#RTPSender-发送器" class="headerlink" title="RTPSender 发送器"></a>RTPSender 发送器</h3><img src="/images/imageWebRTC/RTCRtpSender.png">

<img src="/images/imageWebRTC/RTPMedia.png">

<p>RTCRtpTransceiver 可以同时处理 sender 和 receiver</p>
<img src="/images/imageWebRTC/RTCRtpTransceiver.png">

<h3 id="传输速率的控制"><a href="#传输速率的控制" class="headerlink" title="传输速率的控制"></a>传输速率的控制</h3><img src="/images/imageWebRTC/RTPMedia-01.png">

<img src="/images/imageWebRTC/chromeWebRTC-internals.png">

<p>chrome WebRTC 状态查询地址：<span class="exturl" data-url="Y2hyb21lOi8vd2VicnRjLWludGVybmFscw==" title="chrome://webrtc-internals">chrome://webrtc-internals<i class="fa fa-external-link"></i></span></p>
<h3 id="【实战】WebRTC统计信息"><a href="#【实战】WebRTC统计信息" class="headerlink" title="【实战】WebRTC统计信息"></a>【实战】WebRTC统计信息</h3><p>TODO</p>
<h2 id="WebRTC非音视频数据传输"><a href="#WebRTC非音视频数据传输" class="headerlink" title="WebRTC非音视频数据传输"></a>WebRTC非音视频数据传输</h2><h3 id="传输非音视频数据基础知识"><a href="#传输非音视频数据基础知识" class="headerlink" title="传输非音视频数据基础知识"></a>传输非音视频数据基础知识</h3><img src="/images/imageWebRTC/createDataChannel.png">

<img src="/images/imageWebRTC/option-01.png">

<ul>
<li>ordered - udp包不保证包是有序的（传输非音视频数据的时候包是否是按顺序到达的），webrtc传输音视频的时候使用的是udp，webrtc在upd之上做了一层协议可以保证消息是按顺序到达（底层如果包是乱序的对包进行排序）</li>
<li>maxPacketLifeTime/maxRetransmits - 包存活时间（包最大的存活时间/最大的传输次数），这两个参数是二选一，不能同时使用</li>
</ul>
<img src="/images/imageWebRTC/option-02.png">

<ul>
<li>negotiated - 协商，在创建datachannel的时候可以进行协商</li>
</ul>
<img src="/images/imageWebRTC/使用Options.png">

<img src="/images/imageWebRTC/DataChannel事件.png">

<ul>
<li>onmessage - 当对方有数据过来的时候触发</li>
<li>onopen - 当创建好 datachannel 的时候触发</li>
</ul>
<img src="/images/imageWebRTC/创建RTCDataChannel.png">

<img src="/images/imageWebRTC/非音视频数据传输方式.png">

<ul>
<li><p>SCTP - stream control transport 流控</p>
</li>
<li><p>configurable - 可配置的</p>
</li>
<li><p>Reliability：可靠性</p>
</li>
<li><p>Delivery：可达性</p>
</li>
<li><p>Transmission：传输方式</p>
</li>
<li><p>Flow control：流控</p>
</li>
<li><p>Congestion control：拥塞控制</p>
</li>
</ul>
<h3 id="端到端文本聊天"><a href="#端到端文本聊天" class="headerlink" title="端到端文本聊天"></a>端到端文本聊天</h3><p>TODO</p>
<h3 id="文件实时传输"><a href="#文件实时传输" class="headerlink" title="文件实时传输"></a>文件实时传输</h3><img src="/images/imageWebRTC/知识点.png">

<h2 id="WebRTC实时数据传输网络协议详解"><a href="#WebRTC实时数据传输网络协议详解" class="headerlink" title="WebRTC实时数据传输网络协议详解"></a>WebRTC实时数据传输网络协议详解</h2><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L29zaGlyZGV5L2FydGljbGUvZGV0YWlscy8zODQ2NzM5MQ==" title="https://blog.csdn.net/oshirdey/article/details/38467391">浅析TCP字节流与UDP数据报的区别<i class="fa fa-external-link"></i></span></p>
</blockquote>
<p><strong>tcp是流式传输， 这是什么意思？</strong> </p>
<p>假设A给B通过TCP发了200字节， 然后又发了300字节， 此时B调用recv（设置预期接受1000个字节）， 那么请问B实际接受到多少字节？  根据我们之前讲得tcp粘包特性，可知， B端调用一次recv, 接受到的是500字节。</p>
<p>所谓流式传输， 说白了， 就是管道中的水， 第一次给你发了200斤的水， 第二次给你发了300斤的水， 然后你在对端取的时候， 这200斤和300斤的水， 已经粘在一起了， 无法直接分割， 没有界限了。</p>
<p><strong>udp是数据报传输，  什么意思？</strong>  </p>
<p>假设A给B通过udp发了200字节， 然后又发了300字节， 此时B调用recvfrom（设置预期接受1000个字节）， 那么请问B实际接受到多少字节？   写了个程序测了一下， 发现B调用recvfrom接收到的是200自己， 另外的300字节必须再次调用recvfrom来接收。</p>
<p>所谓的数据报传输， 说白了， 就有消息和消息之间有天然的分割， 对端接收的时候， 不会出现粘包。 发10次， 就需要10次来接收。</p>
<h3 id="【协议规范】RTP-SRTP协议头详解"><a href="#【协议规范】RTP-SRTP协议头详解" class="headerlink" title="【协议规范】RTP-SRTP协议头详解"></a>【协议规范】RTP-SRTP协议头详解</h3><img src="/images/imageWebRTC/协议栈.png">

<img src="/images/imageWebRTC/传输协议.png">

<ul>
<li>DTLS - 证书检测，加密算法协商</li>
</ul>
<img src="/images/imageWebRTC/RTP协议.png">

<ul>
<li>contributing source - 贡献源，CC - 表示贡献者一共有多少个（最多可以表示16个贡献者）</li>
</ul>
<img src="/images/imageWebRTC/RTP字段说明.png">

<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3podXNoZW50aWFuL2FydGljbGUvZGV0YWlscy83OTgwNDc0Mg==" title="https://blog.csdn.net/zhushentian/article/details/79804742">RTP报文头中的SSRC和CSRC<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZm94bWluL2FyY2hpdmUvMjAxMi8wMy8xMy8yMzkzMzQ5Lmh0bWw=" title="https://www.cnblogs.com/foxmin/archive/2012/03/13/2393349.html">RTP/RTCP协议详解<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veF93dWtvbmcvcC82MzkxNjExLmh0bWw=" title="https://www.cnblogs.com/x_wukong/p/6391611.html">RTP 有效负载(载荷)类型，RTP Payload Type<i class="fa fa-external-link"></i></span></p>
</blockquote>
<ul>
<li>最大的 RTP 包包含的字节是1400多字节，压缩后的 H264 帧也能达到 1M 多。一般帧 封包 后的最后一个包 就是 M 位</li>
<li>timestamp - 同一个帧的所有封包的 timestamp 是相同的，并且 seq number 是连续的。H264 内部有封包的起始位和结束位，根据这些标识就可以将多个封包组成一个完整的帧</li>
<li>SSRC - SSRC的作用就是贡献者，视频和音频的SSRC是完全不相同的。同一个视频的SSRC有可能发生变化（产生冲突会发生变化，因为SSRC是随机数）</li>
<li>CSRC - 贡献者</li>
</ul>
<h3 id="【协议规范】RTCP-中的-SR-与-RR-报文"><a href="#【协议规范】RTCP-中的-SR-与-RR-报文" class="headerlink" title="【协议规范】RTCP 中的 SR 与 RR 报文"></a>【协议规范】RTCP 中的 SR 与 RR 报文</h3><img src="/images/imageWebRTC/RTCP包.png">

<img src="/images/imageWebRTC/RTCPPayloadType.png">

<ul>
<li>SDES - 中最重要的一个字段是 cname</li>
<li>FR - 请求关键帧</li>
<li>necho - 发现丢包重传</li>
</ul>
<img src="/images/imageWebRTC/RTCPHeader.png">

<img src="/images/imageWebRTC/RTCPHeader说明.png">

<img src="/images/imageWebRTC/RTCPSenderReport.png">

<img src="/images/imageWebRTC/SenderInfomationBlock.png">

<img src="/images/imageWebRTC/SenderInfo说明.png">

<ul>
<li>NTP - 不同源之间的同步，比如音频和视频之间的同步</li>
</ul>
<img src="/images/imageWebRTC/ReportBlock.png">

<img src="/images/imageWebRTC/ReceiveReportBlock.png">

<img src="/images/imageWebRTC/RTCPReceiverReport.png">

<img src="/images/imageWebRTC/RTCPSR-RR发送时机.png">

<img src="/images/imageWebRTC/RTCPSDES.png">

<img src="/images/imageWebRTC/SDESitem.png">

<img src="/images/imageWebRTC/SDES说明.png">

<ul>
<li>CNAME - 对于webrtc来说这个字段基本上是不用SDES这个消息，因为在SDP中就有CNAME的描述，除非音频源或者视频源发生了中断（or中转）会重新生成SSRC，然后再进行重新绑定</li>
</ul>
<img src="/images/imageWebRTC/RTCPBYE.png">

<img src="/images/imageWebRTC/RTCPAPP.png">

<img src="/images/imageWebRTC/RTCPAPP字段说明.png">

<h3 id="【协议规范】DTSL"><a href="#【协议规范】DTSL" class="headerlink" title="【协议规范】DTSL"></a>【协议规范】DTSL</h3><img src="/images/imageWebRTC/DTLS.png">

<img src="/images/imageWebRTC/SRTP.png">

<h3 id="wireshark-分析-rtp-rtcp-包"><a href="#wireshark-分析-rtp-rtcp-包" class="headerlink" title="wireshark 分析 rtp-rtcp 包"></a>wireshark 分析 rtp-rtcp 包</h3><p>TODO</p>
<h2 id="Android端与浏览器互通"><a href="#Android端与浏览器互通" class="headerlink" title="Android端与浏览器互通"></a>Android端与浏览器互通</h2><h3 id="Android-与浏览器互通"><a href="#Android-与浏览器互通" class="headerlink" title="Android 与浏览器互通"></a>Android 与浏览器互通</h3><img src="/images/imageWebRTC/主要内容.png">

<img src="/images/imageWebRTC/需要权限.png">

<img src="/images/imageWebRTC/Android权限管理.png">

<img src="/images/imageWebRTC/引入库.png">

<img src="/images/imageWebRTC/信令处理.png">

<img src="/images/imageWebRTC/AndroidSocketio.png">

<img src="/images/imageWebRTC/socketio接收消息.png">

<h3 id="WebRTCNative-开发逻辑"><a href="#WebRTCNative-开发逻辑" class="headerlink" title="WebRTCNative 开发逻辑"></a>WebRTCNative 开发逻辑</h3><img src="/images/imageWebRTC/结构图.png">

<img src="/images/imageWebRTC/呼叫端时序图.png">

<img src="/images/imageWebRTC/被叫端时序图.png">

<img src="/images/imageWebRTC/关闭时序图.png">

<img src="/images/imageWebRTC/webrtc处理流程.png">

<img src="/images/imageWebRTC/重要类-01.png">

<img src="/images/imageWebRTC/重要类-02.png">

<img src="/images/imageWebRTC/两个观察者.png">

<h3 id="实战-权限申请-库的引入与界面"><a href="#实战-权限申请-库的引入与界面" class="headerlink" title="实战-权限申请-库的引入与界面"></a>实战-权限申请-库的引入与界面</h3><img src="/images/imageWebRTC/权限库界面.png">

<h3 id="实战-通过-socket-io-实现信令收发"><a href="#实战-通过-socket-io-实现信令收发" class="headerlink" title="实战-通过 socket.io 实现信令收发"></a>实战-通过 socket.io 实现信令收发</h3><img src="/images/imageWebRTC/收发信令.png">

<h3 id="实战-Android-与浏览器互通"><a href="#实战-Android-与浏览器互通" class="headerlink" title="实战-Android 与浏览器互通"></a>实战-Android 与浏览器互通</h3><p>创建 PeerConnection：</p>
<ul>
<li>音视频数据采集</li>
<li>创建 PeerConnection</li>
</ul>
<p>媒体能力协商：</p>
<ul>
<li>协商媒体能力</li>
<li>Candidate 连通</li>
<li>视频渲染</li>
</ul>
<h2 id="iOS端与浏览器互通"><a href="#iOS端与浏览器互通" class="headerlink" title="iOS端与浏览器互通"></a>iOS端与浏览器互通</h2><h3 id="IOS权限获取"><a href="#IOS权限获取" class="headerlink" title="IOS权限获取"></a>IOS权限获取</h3><img src="/images/imageWebRTC/主要内容-01.png">

<img src="/images/imageWebRTC/主要内容-02.png">

<h3 id="IOS引入WebRTC库"><a href="#IOS引入WebRTC库" class="headerlink" title="IOS引入WebRTC库"></a>IOS引入WebRTC库</h3><img src="/images/imageWebRTC/引入WebRTC库的方式.png">

<img src="/images/imageWebRTC/引入WebRTC库.png">

<img src="/images/imageWebRTC/Podfile.png">

<h3 id="IOS端SocketIO的使用"><a href="#IOS端SocketIO的使用" class="headerlink" title="IOS端SocketIO的使用"></a>IOS端SocketIO的使用</h3><img src="/images/imageWebRTC/socketio的使用.png">

<img src="/images/imageWebRTC/连接服务器.png">

<img src="/images/imageWebRTC/发送消息.png">

<img src="/images/imageWebRTC/注册侦听消息.png">

<h3 id="IOS界面布局"><a href="#IOS界面布局" class="headerlink" title="IOS界面布局"></a>IOS界面布局</h3><p>TODO</p>
<h3 id="IOS本地视频采集与展示"><a href="#IOS本地视频采集与展示" class="headerlink" title="IOS本地视频采集与展示"></a>IOS本地视频采集与展示</h3><p>TODO</p>
<h3 id="IOS端RTCPeerConnection"><a href="#IOS端RTCPeerConnection" class="headerlink" title="IOS端RTCPeerConnection"></a>IOS端RTCPeerConnection</h3><p>TODO</p>
<h3 id="IOS媒体协商"><a href="#IOS媒体协商" class="headerlink" title="IOS媒体协商"></a>IOS媒体协商</h3><img src="/images/imageWebRTC/媒体协商.png">

<img src="/images/imageWebRTC/信令时序图.png">

<h3 id="IOS远端视频渲染"><a href="#IOS远端视频渲染" class="headerlink" title="IOS远端视频渲染"></a>IOS远端视频渲染</h3><img src="/images/imageWebRTC/RTCPeerConnection委托.png">

<h2 id="课程总结"><a href="#课程总结" class="headerlink" title="课程总结"></a>课程总结</h2><img src="/images/imageWebRTC/小结.png">

<img src="/images/imageWebRTC/信令服务器.png">

<img src="/images/imageWebRTC/JS客户端实现.png">

<img src="/images/imageWebRTC/JS客户端实现-01.png">

<img src="/images/imageWebRTC/进阶.png">

<img src="/images/imageWebRTC/进阶-01.png">

<img src="/images/imageWebRTC/行业痛点.png">

<h2 id="即时通信（IM）和实时通信（RTC）的区别"><a href="#即时通信（IM）和实时通信（RTC）的区别" class="headerlink" title="即时通信（IM）和实时通信（RTC）的区别"></a>即时通信（IM）和实时通信（RTC）的区别</h2><p>即时通信（IM=Instant messaging）和实时通信（rtc=Real-time communication）都是一套网络通信系统，其本质都是对信息进行转发。其最大的不同点，是对信息传递的时间规定。二者的区别可以从以下几个方面：</p>
<h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><ul>
<li><p><strong>即时通信</strong></p>
<p>常见场景包括文字聊天、语音消息发送、文件传输、音视频播放等。<strong>通俗的说，就是发短信</strong>。</p>
</li>
<li><p><strong>实时通信</strong></p>
<p>场景包括语音、视频电话会议、网络电话等。<strong>通俗的说，就是打电话</strong>。</p>
</li>
</ul>
<h3 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h3><ul>
<li><p><strong>即时通讯</strong></p>
<p>主要要求可靠，考核送达率。要是你发一条短信，结果丢了，对方没收到！你再也不相信短信了吧。</p>
</li>
<li><p><strong>实时通信</strong></p>
<p>主要要求低延时和接通率。</p>
<ul>
<li><strong>低延时</strong>：你打一通电话，每说一句话，对方得几秒钟才有回应，这电话你也讲不下去了吧。</li>
<li><strong>接通率</strong>：你打电话，你这边听到接通了，实际上对方的手机毫无反应，这实际上就没接通。</li>
</ul>
</li>
</ul>
<h3 id="技术环节"><a href="#技术环节" class="headerlink" title="技术环节"></a>技术环节</h3><ul>
<li><p><strong>即时通信</strong></p>
<p>消息发送和确认，【消息接入端、服务端消息逻辑处理，服务端消息缓存和存储，转发，服务端用户状态管理，心跳机制，消息发送端】、消息接收和确认。</p>
</li>
<li><p><strong>实时通信</strong></p>
<p>技术环节：采集、前处理、编码、【服务端接入、转发、服务端接入】、解码、播放和渲染。 </p>
</li>
</ul>
<p>这些技术环节重合的部分是：<strong>信息转发</strong>。</p>
<h3 id="传输协议"><a href="#传输协议" class="headerlink" title="传输协议"></a>传输协议</h3><p>公共互联网上，最常用的通信协议有TCP、UDP。</p>
<ul>
<li><strong>TCP</strong>：Transmission Control Protocol，传输控制协议是基于连接的协议，也就是说，在正式收发数据前，必须和对方建立可靠的连接。<strong>有延迟不可控的特点</strong>。</li>
<li><strong>UDP</strong>：User Data Protocol，用户数据报协议，是与TCP相对应的协议。它是面向非连接的协议，它不与对方建立连接，而是直接就把数据包发送过去。 <strong>存在丢包、抖动、延迟的特征</strong>。</li>
</ul>
<p>即时通信系统为了保证连接的可靠性，最常用的是TCP协议或者类TCP连接协议。这类协议的特点是追求连接的可靠性，而造成了延迟的不可控性，超过2秒的延迟响应是常态，甚至几十分钟的延迟响应，而电信级的实时通信标准是400ms，而基于互联网的实时通信需要另辟蹊径，开创出新的传输解决方案。发短信，延迟几秒钟送达，对使用者影响不大。</p>
<p>实时通信，一般采用 UDP 作为基础传输协议。在设计低延时的实时通信服务时，UDP 表现要比 TCP 好得多。这是因为实时通信中，低时延比可靠性更重要。打电话，几秒的延迟是不能忍受的。</p>
<p>TCP协议封装了消息的重传机制，在丢包的情况下，采用TCP协议的应用程序几乎无法优化这个重传机制，来达到低时延的效果。特别是在移动互联网络中，超过30%丢包时，TCP 的延时可以到几十分钟, 超过 50%丢包时，甚至很容易断开。 在同样丢包30%的链路上，UDP还可以传输数据，TCP就无法进行实时通信了。</p>
<h3 id="成本"><a href="#成本" class="headerlink" title="成本"></a>成本</h3><p>成本涉及到的环节有：<strong>服务端接入、存储和转发</strong>。</p>
<p>二者成本会产生差异的环节有：</p>
<ul>
<li>从服务端接入方式来看，即时通信采用TCP协议来保证可靠性，可能会建立多个连接，相比无连接的UDP传输方式，这是一种昂贵的传输方式。实时通信可以基于UDP协议，与服务端建立灵活的、快速的接入机制。</li>
<li>存储方面，实时通信在服务端是实时转发，不会在服务端存储数据，而即时消息系统一般会将缓存转为存储数据，包括富媒体数据，会占用大量的存储空间，产生更多的存储成本。</li>
<li>从成本上来看，传输同样信息量的数据，基于TCP的即时通信方式，更侧重于可靠性，会优先采用多线机房的传输方式，成本比较高；</li>
<li>而基于UDP的实时通信方式，会优先选取最优路径进行传输数据，并可以动态调整传输路径，这样能够高效的利用带宽，提高传输效率，降低成本。</li>
</ul>
<h3 id="可用的解决方案"><a href="#可用的解决方案" class="headerlink" title="可用的解决方案"></a>可用的解决方案</h3><ul>
<li><strong>即时通信</strong>：XMPP，MQTT</li>
<li><strong>实时通信</strong>：WebRTC、Tokbox</li>
</ul>
<blockquote>
<p>免费的 im 与 rtc 示例：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0YXJydGMvYW5kcm9pZC1kZW1v" title="https://github.com/starrtc/android-demo">https://github.com/starrtc/android-demo<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YzUxMTIxOWU1MWQ0NTUyMmMzMDY2Yzk=" title="https://juejin.im/post/5c511219e51d45522c3066c9">JavaScript 是如何工作的:WebRTC 和对等网络的机制！<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL2EvMTE5MDAwMDAxMTQwMzU5Nw==" title="https://segmentfault.com/a/1190000011403597">深入理解WebRTC<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Zpc2htYWkvYXJ0aWNsZS9kZXRhaWxzLzY5NjgxNTk1" title="https://blog.csdn.net/fishmai/article/details/69681595">WebRTC架构简介<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmFycmV0bGVlLmNvbS9ibG9nLzIwMTUvMTAvMDUvaG93LXRvLWJ1aWxkLWEtaHR0cHMtc2VydmVyLw==" title="https://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/">HTTPS证书生成原理和部署细节<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC85MDkxZWJkNDM5YTA=" title="https://www.jianshu.com/p/9091ebd439a0">SSL证书生成流程<i class="fa fa-external-link"></i></span></p>
</blockquote>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ncmFkbGUub3JnL2luc3RhbGwv" title="https://gradle.org/install/">Gradle官网<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmFuZHJvaWQtc3R1ZGlvLm9yZy9pbmRleC5waHAvOS10b29scy8xMDktYW5kcm9pZC10b29scy1kb3dubG9hZA==" title="http://tools.android-studio.org/index.php/9-tools/109-android-tools-download">Gradle 包<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8zNmU1NjljMWJiMTI=" title="https://www.jianshu.com/p/36e569c1bb12">Mac下AndroidStudio中手动配置Gradle<i class="fa fa-external-link"></i></span></p>
</blockquote>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/X19iaXo9TXpVMU5URXpPVE01TXc9PSZtaWQ9MjI0NzQ4NTk2NiZpZHg9MSZzbj0xMTM5MjBhZTdjNGY5MDhmNDU3NmZiY2MxNDg0NzgxYSZjaGtzbT1mYmQ5YTIyMGNjYWUyYjM2YWE4Nzk2ZjAyZjM3ZGE0ZTE5NzQ4YTQyNjM1YTVmOGFkNzI1NTRkZDA1YWI5N2ZlMDk0ZTI4MjI3OTA1Jm1wc2hhcmU9MSZzY2VuZT0xJnNyY2lkPTA1MjkydEZCeFc3VTJEUkphYVN2cXdHMiNyZA==" title="https://mp.weixin.qq.com/s?__biz=MzU1NTEzOTM5Mw==&mid=2247485966&idx=1&sn=113920ae7c4f908f4576fbcc1484781a&chksm=fbd9a220ccae2b36aa8796f02f37da4e19748a42635a5f8ad72554dd05ab97fe094e28227905&mpshare=1&scene=1&srcid=05292tFBxW7U2DRJaaSvqwG2#rd">WebRTC的拥塞控制和带宽策略<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3l1bnhpbi4xNjMuY29tL2Jsb2cvdmlkZW8xOC0wOTA1Lw==" title="http://yunxin.163.com/blog/video18-0905/">小议WebRTC拥塞控制算法：GCC介绍<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VydmVyY29kZXIuY29tLzIwMTkvMDQvMjQvd2VicnRjLXN0YXRpc3RpY3Mv" title="https://www.servercoder.com/2019/04/24/webrtc-statistics/">***详读webrtc的视频统计信息之延迟、抖动与丢包<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="socket-io-原理详解"><a href="#socket-io-原理详解" class="headerlink" title="socket.io 原理详解"></a>socket.io 原理详解</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTMyNDMzNDcvYXJ0aWNsZS9kZXRhaWxzLzg2NjY5OTg4" title="https://blog.csdn.net/u013243347/article/details/86669988">socket.io 原理详解<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="音视频数据采集与控制"><a href="#音视频数据采集与控制" class="headerlink" title="音视频数据采集与控制"></a>音视频数据采集与控制</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC81YThhOTFjZDg0ZWY=" title="https://www.jianshu.com/p/5a8a91cd84ef">WebRTC音频引擎实现分析<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZmFuZ2ttL3AvNDM3NDY2OC5odG1s" title="https://www.cnblogs.com/fangkm/p/4374668.html">WebRTC手记之本地音频采集<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpbmNhaWcvYXJ0aWNsZS9kZXRhaWxzLzgxMjA5ODk1IyVFNSU5QiU5QiVFMyU4MCU4MVdlYlJUQyVFOSU5RiVCMyVFOCVBNyU4NiVFOSVBMiU5MSVFNSU5MCU4QyVFNiVBRCVBNSVFNiVCQSU5MCVFNyVBMCU4MSVFNSU4OCU4NiVFNiU5RSU5MA==" title="https://blog.csdn.net/lincaig/article/details/81209895#%E5%9B%9B%E3%80%81WebRTC%E9%9F%B3%E8%A7%86%E9%A2%91%E5%90%8C%E6%AD%A5%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">WebRTC音视频同步分析<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpbmNhaWcvYXJ0aWNsZS9kZXRhaWxzLzg2NTAwNjU2" title="https://blog.csdn.net/lincaig/article/details/86500656">webrtc数据接收、解码、渲染等接口调用流程图<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpbmNhaWcvYXJ0aWNsZS9kZXRhaWxzLzc5NTg3NDE3" title="https://blog.csdn.net/lincaig/article/details/79587417">WebRTC视频采集和编码过程<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpbmNhaWcvYXJ0aWNsZS9kZXRhaWxzLzg0NTk0NzY0" title="https://blog.csdn.net/lincaig/article/details/84594764">H264中4x4、8x8和16x16尺寸对应场景<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="NAT-穿越"><a href="#NAT-穿越" class="headerlink" title="NAT 穿越"></a>NAT 穿越</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC84NGU4Yzc4Y2E2MWQ=" title="https://www.jianshu.com/p/84e8c78ca61d">ICE协议下NAT穿越的实现（STUN&amp;TURN）<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGlhb2ZlbmdmZW5nemhhbmcvcC82NTkwNjg3Lmh0bWw=" title="https://www.cnblogs.com/xiaofengfengzhang/p/6590687.html">WebRTC中NAT穿透浅析<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="ICE-原理"><a href="#ICE-原理" class="headerlink" title="ICE 原理"></a>ICE 原理</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2FuZ2xlMTAwMTk4Ni9wLzYwODM4NzEuaHRtbA==" title="https://www.cnblogs.com/wangle1001986/p/6083871.html">（转）NAT与NAT穿越学习总结–ICE过程讲的不错<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZvaXBtYWtlci9hcnRpY2xlL2RldGFpbHMvODQ1MzcwMg==" title="https://blog.csdn.net/voipmaker/article/details/8453702">ICE 原理学习<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="媒体协商过程"><a href="#媒体协商过程" class="headerlink" title="媒体协商过程"></a>媒体协商过程</h3><blockquote>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5jdGlmb3J1bS5jb20vbmV3cy9ndWFuZGlhbi81NDk4NTcuaHRtbA==" title="http://www.ctiforum.com/news/guandian/549857.html">完整WebRTC技术及应用概要<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxMzU4NDAxL2FydGljbGUvZGV0YWlscy83OTM0MTAzMQ==" title="https://blog.csdn.net/qq_21358401/article/details/79341031">WebRTC SDP协议<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8wMjZjN2VmMjcxY2I=" title="https://www.jianshu.com/p/026c7ef271cb">WebRTC 中的 SDP 协议<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="网络处理与流程"><a href="#网络处理与流程" class="headerlink" title="网络处理与流程"></a>网络处理与流程</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RvaXRzanovYXJ0aWNsZS9kZXRhaWxzLzUyMDIyNjQy" title="https://blog.csdn.net/doitsjz/article/details/52022642">WEBRTC 视频接收原理及流程<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05CX3ZvbF8xL2FydGljbGUvZGV0YWlscy84MjExOTQ1MA==" title="https://blog.csdn.net/NB_vol_1/article/details/82119450">webrtc(11) 数据接收——总流程<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLndpbGRkb2cuY29tLz9wPTIxOTY=" title="https://blog.wilddog.com/?p=2196">WebRTC 是如何进行通信的，WebRCT 的三种网络结构 | 野狗 WebRTC 专栏<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL25ndWRyZWFtLmNvbS8yMDE2LzAxLzE4L3dlYnJ0Yy1zdHJ1Y3R1cmUv" title="http://ngudream.com/2016/01/18/webrtc-structure/">WebRTC 音视频引擎研究 – 整体架构分析<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="如何实现并规模高并发"><a href="#如何实现并规模高并发" class="headerlink" title="如何实现并规模高并发"></a>如何实现并规模高并发</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YjU2OGY3YTZmYjlhMDRmYWQzYTFiOWY=" title="https://juejin.im/post/5b568f7a6fb9a04fad3a1b9f">即构自研WebRTC网关服务器架构实践<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9uZXcucXEuY29tL29tbi8yMDE4MDkwOS8yMDE4MDkwOUExMFhGUS5odG1s" title="https://new.qq.com/omn/20180909/20180909A10XFQ.html">WebRTC、标准测试、大前端技术、实时网络质量……RTC2018帮你“划重点”！<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="如何更好的利用网络"><a href="#如何更好的利用网络" class="headerlink" title="如何更好的利用网络"></a>如何更好的利用网络</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xMDA0NjYx" title="https://cloud.tencent.com/developer/article/1004661">WebRTC 点对点直播<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="回音消除与降噪"><a href="#回音消除与降噪" class="headerlink" title="回音消除与降噪"></a>回音消除与降噪</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Rhbm5pbmd6aG9uZy9hcnRpY2xlL2RldGFpbHMvODg2NjQzMzg=" title="https://blog.csdn.net/tanningzhong/article/details/88664338">WebRTC音频降噪使用<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy52b2lkY24uY29tL2FydGljbGUvcC13Y2x0ZHFidC1iY2suaHRtbA==" title="http://www.voidcn.com/article/p-wcltdqbt-bck.html">webrtc–AudioProcessing– 音频降噪的处理过程<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83N2EzNjM5NjA3MTE=" title="https://www.jianshu.com/p/77a363960711">PCM音频处理——使用WebRTC音频降噪模块与其他方式的对比<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5mb3EuY24vYXJ0aWNsZS9RT3A0SU9hb19ESko2ZU5zSU9YcA==" title="https://www.infoq.cn/article/QOp4IOao_DJJ6eNsIOXp">音频降噪在 58 直播中的研究与实现<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbW9kMTA5L3AvNTQ2OTc5OS5odG1s" title="https://www.cnblogs.com/mod109/p/5469799.html">单独编译和使用webrtc音频回声消除模块(附完整源码+测试音频文件)<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vaWNlZGJlZXIvV2VicnRjX0F1ZGlv" title="https://gitee.com/icedbeer/Webrtc_Audio">借助Webrtc音频采集、降噪、回音消除、静音检测、编解码、播放等功能，剥离Webrtc自带的RTP传输协议，使用私有的协议进行传输。从而实现自己的实时语音聊天功能。<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5jY2xrLmNjLzIwMTcvMDgvMTQvd2VicnRjL3dlYnJ0YyVFNSVBRCVBNiVFNCVCOSVBMDItJUU5JTlGJUIzJUU5JUEyJTkxJUU5JUEyJTg0JUU1JUE0JTg0JUU3JTkwJTg2JUU2JUE4JUExJUU1JTlEJTk3Lw==" title="http://www.cclk.cc/2017/08/14/webrtc/webrtc%E5%AD%A6%E4%B9%A02-%E9%9F%B3%E9%A2%91%E9%A2%84%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97/">webrtc学习2-音频预处理模块<i class="fa fa-external-link"></i></span></p>
</blockquote>
<h3 id="OpenCV"><a href="#OpenCV" class="headerlink" title="OpenCV"></a>OpenCV</h3><p>TODO</p>
<h3 id="OpenGL视频渲染"><a href="#OpenGL视频渲染" class="headerlink" title="OpenGL视频渲染"></a>OpenGL视频渲染</h3><p>TODO</p>
<p>WebRTC的分层协议图：</p>
<img src="/images/imageWebRTC/webrtc分层协议图.png">

<p>信令，会话和协议：</p>
<img src="/images/imageWebRTC/信令会话协议.png">

<h2 id="问题解决里程"><a href="#问题解决里程" class="headerlink" title="问题解决里程"></a>问题解决里程</h2><p>node 启动 server 报错：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">events.js:141</span><br><span class="line">      throw er; // Unhandled 'error' event</span><br><span class="line">      ^</span><br><span class="line"></span><br><span class="line">Error: listen EACCES 0.0.0.0:443</span><br><span class="line">    at Object.exports._errnoException (util.js:870:11)</span><br><span class="line">    at exports._exceptionWithHostPort (util.js:893:20)</span><br><span class="line">    at Server._listen2 (net.js:1224:19)</span><br><span class="line">    at listen (net.js:1273:10)</span><br><span class="line">    at net.js:1382:9</span><br><span class="line">    at nextTickCallbackWith3Args (node.js:452:9)</span><br><span class="line">    at process._tickCallback (node.js:358:17)</span><br><span class="line">    at Function.Module.runMain (module.js:444:11)</span><br><span class="line">    at startup (node.js:136:18)</span><br><span class="line">    at node.js:966:3</span><br><span class="line"><span class="meta">[Solve]$</span><span class="bash"> sudo <span class="built_in">setcap</span> <span class="string">'cap_net_bind_service=+ep'</span> $(readlink -f $(<span class="built_in">which</span> node))</span></span><br></pre></td></tr></table></figure>

<p>查询端口是否别占用：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Linux</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> netstat -ntpl | grep 443</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> MacOS</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lsof 通过list open file命令可以查看到当前打开文件，在linux中所有事物都是以文件形式存在，包括网络连接及硬件设备。</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo lsof -i:80  // sudo lsof -i tcp:80</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -i 参数表示网络链接，:80 指明端口号，该命令会同时列出 PID</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo lsof -i -P | grep -i <span class="string">"listen"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有进程监听的端口</span></span><br></pre></td></tr></table></figure>

<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p><img src="/images/imageWebRTC/supplement/1V1%E4%BA%92%E5%8A%A8%E7%9B%B4%E6%92%AD%E9%80%9A%E8%AE%AF%E8%BF%87%E7%A8%8B.png" alt="1V1互动直播通讯过程"></p>
<p><img src="/images/imageWebRTC/supplement/TIM-01.jpg" alt="知识框架介绍"></p>
<p><img src="/images/imageWebRTC/supplement/TIM-02.jpg" alt="知识框架介绍"></p>
<p><img src="/images/imageWebRTC/supplement/WebRTC-ICECandidateExchange.svg" alt="WebRTC-ICE Candidate Exchange"></p>
<p><img src="/images/imageWebRTC/supplement/WebRTC-SignalingDiagram.svg" alt="WebRTC-Signaling Diagram"></p>
<details><summary>turnserver.conf</summary>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RFC5766-TURN-SERVER configuration file</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RFC5766-TURN-SERVER配置文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Boolean values note: <span class="built_in">where</span> boolean value is supposed to be used,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> you can use <span class="string">'0'</span>, <span class="string">'off'</span>, <span class="string">'no'</span>, <span class="string">'false'</span>, <span class="string">'f'</span> as <span class="string">'false,</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and you can use <span class="string">'1'</span>, <span class="string">'on'</span>, <span class="string">'yes'</span>, <span class="string">'true'</span>, <span class="string">'t'</span> as <span class="string">'true'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If the value is missed, <span class="keyword">then</span> it means <span class="string">'true'</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 布尔值注意: 布尔值应该被使用,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 您可以使用<span class="string">'0'</span>, <span class="string">'off'</span>, <span class="string">'no'</span>, <span class="string">'false'</span>, <span class="string">'f'</span> 相当于 <span class="string">'false,</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 还有你可以用<span class="string">'1'</span>, <span class="string">'on'</span>, <span class="string">'yes'</span>, <span class="string">'true'</span>, <span class="string">'t'</span> 相当于 <span class="string">'true'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有值，相当于<span class="string">'true'</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Listener interface device (optional, Linux only).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> NOT RECOMMENDED.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 侦听器接口设备(仅可选,Linux)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不推荐。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">listening-device=eth0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN listener port <span class="keyword">for</span> UDP and TCP (Default: 3478).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Note: actually, TLS &amp; DTLS sessions can connect to the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">"plain"</span> TCP &amp; UDP port(s), too - <span class="keyword">if</span> allowed by configuration.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN为UDP和TCP的侦听器端口(默认: 3478)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注:实际上,TLS和DTLS会话可以连接到<span class="string">"清晰的"</span>TCP和UDP端口,——如果允许配置。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">listening-port=3478</span></span><br><span class="line">listening-port=3478</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN listener port <span class="keyword">for</span> TLS (Default: 5349).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Note: actually, <span class="string">"plain"</span> TCP &amp; UDP sessions can connect to the TLS &amp; DTLS</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> port(s), too - <span class="keyword">if</span> allowed by configuration. The TURN server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">"automatically"</span> recognizes the <span class="built_in">type</span> of traffic. Actually, two listening</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> endpoints (the <span class="string">"plain"</span> one and the <span class="string">"tls"</span> one) are equivalent <span class="keyword">in</span> terms of</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> functionality; but we keep both endpoints to satisfy the RFC 5766 specs.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> For secure TCP connections, we currently support SSL version 3 and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TLS version 1.0, 1.1 and 1.2. SSL2 <span class="string">"encapculation mode"</span> is also supported.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> For secure UDP connections, we support DTLS version 1.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN为TLS的侦听器端口(默认: 5349)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意:事实上,<span class="string">"清晰的"</span>TCP和UDP会话可以连接到TLS和DTLS端口，如果允许配置。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN服务器<span class="string">"自动"</span>识别传输类型。实际上,两个监听终端点(<span class="string">"清晰的"</span>端和<span class="string">"TLS"</span>端)是</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 对等的功能;但我们保持两个端点来满足RFC 5766规范。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 对于安全的TCP连接,我们目前支持SSL的3个版本，是TLS 1.0版本,1.1版本和1.2版本。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> SSL2还支持<span class="string">"encapculation模式"</span>。对于安全的UDP连接,我们支持DTLS版本1。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">tls-listening-port=5349</span></span><br><span class="line">tls-listening-port=5349</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Alternative listening port <span class="keyword">for</span> UDP and TCP listeners;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default (or zero) value means <span class="string">"listening port plus one"</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is needed <span class="keyword">for</span> RFC 5780 support</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (STUN extension specs, NAT behavior discovery). The TURN Server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> supports RFC 5780 only <span class="keyword">if</span> it is started with more than one</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> listening IP address of the same family (IPv4 or IPv6).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RFC 5780 is supported only by UDP protocol, other protocols</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> are listening to that endpoint only <span class="keyword">for</span> <span class="string">"symmetry"</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择UDP和TCP监听器监听端口;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认(或者0)是表示监听的端口加1.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是必须的，为了RFC 5780的支持(STUN的扩展规范, NAT后端的发现)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN服务器支持RFC 5780只有启动与多个监听同一族的IP地址(IPv4或IPv6).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RFC 5780只有UDP协议,支持其他协议是监听<span class="string">"对称"</span>型端口的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">alt-listening-port=0</span></span><br><span class="line">                                   </span><br><span class="line"><span class="meta">#</span><span class="bash"> Alternative listening port <span class="keyword">for</span> TLS and DTLS protocols.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default (or zero) value means <span class="string">"TLS listening port plus one"</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择监听端口TLS和DTLS协议。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认(或者0)是表示TLS监听的端口加1.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">alt-tls-listening-port=0</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#</span><span class="bash"> Listener IP address of relay server. Multiple listeners can be specified.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If no IP(s) specified <span class="keyword">in</span> the config file or <span class="keyword">in</span> the <span class="built_in">command</span> line options,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">then</span> all IPv4 and IPv6 system IPs will be used <span class="keyword">for</span> listening.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 侦听器中继服务器的IP地址。可以指定多个侦听器。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有在配置文件或者命令选项中指定监听的IP，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 那么所有的IPv4和IPv6所有的IP将被监听</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">listening-ip=172.26.7.151</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Auxiliary STUN/TURN server listening endpoint.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Aux servers have almost full TURN and STUN functionality.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The (minor) limitations are:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1) Auxiliary servers <span class="keyword">do</span> not have alternative ports and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> they <span class="keyword">do</span> not support STUN RFC 5780 functionality (CHANGE REQUEST).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2) Auxiliary servers also are never returning ALTERNATIVE-SERVER reply.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Valid formats are 1.2.3.4:5555 <span class="keyword">for</span> IPv4 and [1:2::3:4]:5555 <span class="keyword">for</span> IPv6.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> There may be multiple aux-server options, each will be used <span class="keyword">for</span> listening</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> to client requests.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 辅助STUN/TURN服务器监听端口。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 辅助服务器几乎有齐TURN和STUN功能</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (一些)局限性:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1) 辅助服务器没有替代的端口并且他们不支持STUN RFC 5780功能(变更请求)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2) 辅助服务器也不会返回ALTERNATIVE-SERVER回复。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 有效格式，IPv4的1.2.3.4:5555 和IPv6的[1:2::3:4]:5555。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可能会有多个aux-server选项,每个将用于监听客户端请求。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">aux-server=172.17.19.110:33478</span></span><br><span class="line"><span class="meta">#</span><span class="bash">aux-server=[2607:f0d0:1002:51::4]:33478</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> (recommended <span class="keyword">for</span> older Linuxes only)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Automatically balance UDP traffic over auxiliary servers (<span class="keyword">if</span> configured).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The load balancing is using the ALTERNATE-SERVER mechanism.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The TURN client must support 300 ALTERNATE-SERVER response <span class="keyword">for</span> this</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> functionality.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (仅推荐老的Linuxes)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在辅助服务器自动均衡UDP流量(如果配置)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用ALTERNATE-SERVER的负载均衡机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN客户端必须支持300个ALTERNATE-SERVER响应。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">udp-self-balance</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Relay interface device <span class="keyword">for</span> relay sockets (optional, Linux only).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> NOT RECOMMENDED.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 终极接口设备为中继套接字(可选, 仅Linux).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不推荐。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">relay-device=eth1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Relay address (the <span class="built_in">local</span> IP address that will be used to relay the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> packets to the peer).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Multiple relay addresses may be used.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The same IP(s) can be used as both listening IP(s) and relay IP(s).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If no relay IP(s) specified, <span class="keyword">then</span> the turnserver will apply the default</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> policy: it will decide itself <span class="built_in">which</span> relay addresses to be used, and it</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> will always be using the client socket IP address as the relay IP address</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> of the TURN session (<span class="keyword">if</span> the requested relay address family is the same</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as the family of the client socket).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 中继地址(本地IP地址将用于传递数据包的给每个端)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以使用多个中继地址。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 相同的IP可以用作监听IP和继电器IP。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有指定中继IP，那么turnserver将应用默认策略：它将自行决定使用那个中继</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 地址，并且它总是会使用客户端套接字的IP地址作为中继的IP地址在TURN会话中(如果</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 请求的中继地址族解决同族的客户端套接字)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">relay-ip=172.17.19.105</span></span><br><span class="line"><span class="meta">#</span><span class="bash">relay-ip=2607:f0d0:1002:51::5</span></span><br><span class="line">relay-ip=172.26.7.151</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> For Amazon EC2 users:<span class="comment">#</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN Server public/private address mapping, <span class="keyword">if</span> the server is behind NAT.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In that situation, <span class="keyword">if</span> a -X is used <span class="keyword">in</span> form <span class="string">"-X &lt;ip&gt;"</span> <span class="keyword">then</span> that ip will be reported</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as relay IP address of all allocations. This scenario works only <span class="keyword">in</span> a simple <span class="keyword">case</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> when one single relay address is be used, and no RFC5780 functionality is required.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> That single relay address must be mapped by NAT to the <span class="string">'external'</span> IP.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The <span class="string">"external-ip"</span> value, <span class="keyword">if</span> not empty, is returned <span class="keyword">in</span> XOR-RELAYED-ADDRESS field.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> For that <span class="string">'external'</span> IP, NAT must forward ports directly (relayed port 12345</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> must be always mapped to the same <span class="string">'external'</span> port 12345).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In more complex <span class="keyword">case</span> when more than one IP address is involved,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> that option must be used several <span class="built_in">times</span>, each entry must</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> have form <span class="string">"-X &lt;public-ip/private-ip&gt;"</span>, to map all involved addresses.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RFC5780 NAT discovery STUN functionality will work correctly,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span> the addresses are mapped properly, even when the TURN server itself</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> is behind A NAT.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, this value is empty, and no address mapping is used.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Amazon EC2用户:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN服务器公开/私有的地址映射，假如服务器是在NAT后端。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在这种情况下,如果一个表单中<span class="string">"-X &lt;ip&gt;"</span>使用一个-X，然后该ip将被作为中继ip地址来使用。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这种情况只适用于一个简单的例子,当一个中继的地址是被使用,和没有RFC5780功能是必需的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 单个中继地址必须通过NAT映射到外部的IP。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 外部的IP值，假如不为空，通过XOR-RELAYED-ADDRESS字段返回。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 外部的IP,NAT必须直接转发端口(转发端口12345，必须总是映射到相同的外部端口12345)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在更复杂的情况下,当涉及到多个IP地址,这个选项必须使用几次,每个条目必须形</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 成<span class="string">"-X &lt;public-ip/private-ip&gt;"</span>,将所有涉及到的地址。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RFC5780 NAT发现STUN功能正常工作，如果正确的地址映射,即使TURN服务器本身是</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在一个NAT后。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认，该值为空，并且没有使用地址映射。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">external-ip=60.70.80.91</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">OR:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">external-ip=60.70.80.91/172.17.19.101</span></span><br><span class="line"><span class="meta">#</span><span class="bash">external-ip=60.70.80.92/172.17.19.102</span></span><br><span class="line">external-ip=47.92.119.215</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Number of relay threads to handle the established connections</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (<span class="keyword">in</span> addition to authentication thread and the listener thread).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If <span class="built_in">set</span> to 0 <span class="keyword">then</span> application runs relay process <span class="keyword">in</span> a single thread,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span> the same thread with the listener process (the authentication thread will</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> still be a separate thread).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In the older systems (Linux kernel before 3.9),</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the number of UDP threads is always one thread per network listening endpoint -</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> including the auxiliary endpoints - unless 0 (zero) or 1 (one) value is <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 数量的中继线程处理建立连接(除了验证线程和侦听器线程)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果设置为0,那么应用程序中继进程在一个线程中运行,在同一</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 个线程中监听处理(身份验证线程仍然是一个单独的线程)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在旧系统(3.9 Linux内核之前),数量的UDP线程总是一个线程监听一个网络端点,包括辅助端点——除非设置0或1值。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">relay-threads=0</span></span><br><span class="line">relay-threads=10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Lower and upper bounds of the UDP relay endpoints:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (default values are 49152 and 65535)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> UDP中继端点的上下边界:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (默认是49152至65535)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">min-port=49152</span><br><span class="line">max-port=65535</span><br><span class="line">    </span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment to run TURN server <span class="keyword">in</span> <span class="string">'normal'</span> <span class="string">'moderate'</span> verbose mode.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default the verbose mode is off.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消TURN服务器运行<span class="string">'normal'</span> <span class="string">'moderate'</span>详细模式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,详细模式是关闭的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">verbose</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment to run TURN server <span class="keyword">in</span> <span class="string">'extra'</span> verbose mode.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This mode is very annoying and produces lots of output.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Not recommended under any normal circumstances.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消TURN服务器运行<span class="string">'extra'</span>详细模式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这种模式是非常恼人的,产生大量的输出。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在任何正常情况下不建议。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">Verbose</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment to use fingerprints <span class="keyword">in</span> the TURN messages.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default the fingerprints are off.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消在TURN消息中使用指纹。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,指纹是关闭的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">fingerprint</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment to use long-term credential mechanism.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default no credentials mechanism is used (any user allowed).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option can be used with either flat file user database or</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PostgreSQL DB or MySQL DB or Redis DB <span class="keyword">for</span> user keys storage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消使用长期证书机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下不使用凭证机制(允许任何用户)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项可能使用用户数据文件或PostgreSQL或MySQL或Redis来存储用户密钥。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">lt-cred-mech</span></span><br><span class="line">lt-cred-mech</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment to use short-term credential mechanism.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default no credentials mechanism is used (any user allowed).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> For short-term credential mechanism you have to use PostgreSQL or</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> MySQL or Redis database <span class="keyword">for</span> user password storage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消使用短期证书机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下不使用凭证机制(允许任何用户)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 短期证书机制必须使用PostgreSQL或MySQL或Redis数据库来存储用户密码。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">st-cred-mech</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option is opposite to lt-cred-mech or st-cred-mech.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (TURN Server with no-auth option allows anonymous access).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If neither option is defined, and no users are defined,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">then</span> no-auth is default. If at least one user is defined,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span> this file or <span class="keyword">in</span> <span class="built_in">command</span> line or <span class="keyword">in</span> usersdb file, <span class="keyword">then</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lt-cred-mech is default.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项是lt-cred-mech或st-cred-mech相反。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (TURN服务器no-auth选项允许匿名访问)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有选项定义,没有用户定义,那么no-auth默认。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果至少定义有一个用户,在这个文件中或在命令行或usersdb文件,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 那么lt-cred-mech默认。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-auth</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN REST API flag.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Flag that sets a special authorization option that is based upon authentication secret.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This feature can be used with the long-term authentication mechanism, only.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This feature purpose is to support <span class="string">"TURN Server REST API"</span>, see</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">"TURN REST API"</span> link <span class="keyword">in</span> the project<span class="string">'s page</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://code.google.com/p/rfc5766-turn-server/.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option is used with timestamp:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> usercombo -&gt; <span class="string">"timestamp:userid"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> turn user -&gt; usercombo</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> turn password -&gt; base64(hmac(secret key, usercombo))</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This allows TURN credentials to be accounted <span class="keyword">for</span> a specific user id.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If you don<span class="string">'t have a suitable id, the timestamp alone can be used.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option is just turning on secret-based authentication.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The actual value of the secret is defined either by option static-auth-secret,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> or can be found <span class="keyword">in</span> the turn_secret table <span class="keyword">in</span> the database (see below).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN REST API标志。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 标志是设置一个特殊的授权选项,是基于身份验证的私密。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个功能可以用于长期验证机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个功能的目的是支持<span class="string">"TURN Server REST API"</span>,看到<span class="string">"TURN Server REST API"</span>项目的页面的链接</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://code.google.com/p/rfc5766-turn-server/。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项是使用时间戳:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> usercombo -&gt; <span class="string">"timestamp:userid"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> turn user -&gt; usercombo</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> turn password -&gt; base64(hmac(secret key, usercombo))</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这允许TURN凭证占用一个特定的用户id。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果你没有一个合适的id,可以使用单独的时间戳。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项只是打开基于私密的身份验证。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 实际值定义的私密就是通过选择static-auth-secret,或可以在数据库中找到turn_secret表(见下文)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">use-auth-secret</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Static'</span> authentication secret value (a string) <span class="keyword">for</span> TURN REST API only.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If not <span class="built_in">set</span>, <span class="keyword">then</span> the turn server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> will try to use the <span class="string">'dynamic'</span> value <span class="keyword">in</span> turn_secret table</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span> user database (<span class="keyword">if</span> present). The database-stored  value can be changed on-the-fly</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> by a separate program, so this is why that other mode is <span class="string">'dynamic'</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN REST API的<span class="string">'Static'</span>身份验证的私密值(字符串)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有设置，那么turn服务器将尝试使用<span class="string">'dynamic'</span>值在用户数据库的turn_secret表(如果存在)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据库存储的值可以随时改变，通过单独的程序，所以这就是<span class="string">'dynamic'</span>模式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">static-auth-secret=ling </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Static'</span> user accounts <span class="keyword">for</span> long term credentials mechanism, only.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option cannot be used with TURN REST API or with short-term credentials</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> mechanism.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Static'</span> user accounts are NOT dynamically checked by the turnserver process,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> so that they can NOT be changed <span class="keyword">while</span> the turnserver is running.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Static'</span>用户长期占凭证机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项不能用于TURN REST API或短期凭证机制。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Static'</span>用户帐户不是turnserver程序动态检查,所以他们不能改变在turnserver运行时。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">user=username1:key1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">user=username2:key2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> OR:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">user=username1:password1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">user=username2:password2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Keys must be generated by turnadmin utility. The key value depends</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> on user name, realm, and password:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 钥匙必须由turnadmin实用程序生成。键值取决于用户名称、领域和密码:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 例子,使用以下命令:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> $ turnadmin -k -u ninefingers -r north.gov -p youhavetoberealistic</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Output: 0xbc807ee29df3c9ffa736523fb2c4e8ee</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 输出是: 0xbc807ee29df3c9ffa736523fb2c4e8ee</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (<span class="string">'0x'</span> <span class="keyword">in</span> the beginning of the key is what differentiates the key from</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> password. If it has 0x <span class="keyword">then</span> it is a key, otherwise it is a password).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (<span class="string">'0x'</span>开始的关键是区分从密码的关键。如果它有0x,那么它是一个关键,否则这是一个密码)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The corresponding user account entry <span class="keyword">in</span> the config file will be:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 相应的配置文件中的用户帐户条目将:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">user=ninefingers:0xbc807ee29df3c9ffa736523fb2c4e8ee</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Or, equivalently, with open clear password (less secure):</span></span><br><span class="line"><span class="meta">#</span><span class="bash">或者是这样，明文密码(不安全的):</span></span><br><span class="line">user=ling:0xc93be9d24fb0eab034f539c855528a26</span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">user=ling:ling1234</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Dynamic'</span> user accounts database file name.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Only users <span class="keyword">for</span> long-term mechanism can be stored <span class="keyword">in</span> a flat file,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> short-term mechanism will not work with option, the short-term</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> mechanism required PostgreSQL or MySQL or Redis database.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Dynamic'</span> long-term user accounts are dynamically checked by the turnserver process,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> so that they can be changed <span class="keyword">while</span> the turnserver is running.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default file name is turnuserdb.conf.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Dynamic'</span>用户帐户数据库文件名。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只有用户长期机制可以存储在一个文件,短期机制不会处理选项,短期机制需要PostgreSQL或MySQL或</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis数据库。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'Dynamic'</span>的长期用户帐户在turnserver程序中动态检查的,这样他们可以改变的在turnserver运行时。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认文件名是turnuserdb.conf.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">userdb=/usr/<span class="built_in">local</span>/etc/turnuserdb.conf</span></span><br><span class="line">userdb=/etc/turnuserdb.conf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> PostgreSQL database connection string <span class="keyword">in</span> the <span class="keyword">case</span> that we are using PostgreSQL</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as the user database.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This database can be used <span class="keyword">for</span> long-term and short-term credential mechanisms</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and it can store the secret value <span class="keyword">for</span> secret-based timed authentication <span class="keyword">in</span> TURN RESP API.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See http://www.postgresql.org/docs/8.4/static/libpq-connect.html <span class="keyword">for</span> 8.x PostgreSQL</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> versions connection string format, see</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://www.postgresql.org/docs/9.2/static/libpq-connect.html<span class="comment">#LIBPQ-CONNSTRING</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span> 9.x and newer connection string formats.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PostgreSQL数据库连接字符串,使用PostgreSQL作为用户数据库。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 该数据库可用于长期和短期证书机制,它可以存储的私密值，为基于私密身份验证的在TURN RESP API中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 8.x PostgreSQL版本请参见http://www.postgresql.org/docs/8.4/static/libpq-connect.html的连接字符串</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 格式,9.x和更新的请参阅http://www.postgresql.org/docs/9.2/static/libpq-connect.html LIBPQ-CONNSTRING</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 的连接字符串格式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">psql-userdb=<span class="string">"host=&lt;host&gt; dbname=&lt;database-name&gt; user=&lt;database-user&gt; password=&lt;database-user-password&gt; connect_timeout=30"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> MySQL database connection string <span class="keyword">in</span> the <span class="keyword">case</span> that we are using MySQL</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as the user database.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This database can be used <span class="keyword">for</span> long-term and short-term credential mechanisms</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and it can store the secret value <span class="keyword">for</span> secret-based timed authentication <span class="keyword">in</span> TURN RESP API.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use string format as below (space separated parameters, all optional):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> MySQL数据库连接字符串,使用MySQL作为用户数据库。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 该数据库可用于长期和短期证书机制,它可以存储的私密值，为基于私密身份验证的在TURN RESP API中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用字符串格式如下(空间分离参数,所有可选):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">mysql-userdb=<span class="string">"host=&lt;host&gt; dbname=&lt;database-name&gt; user=&lt;database-user&gt; password=&lt;database-user-password&gt; port=&lt;port&gt; connect_timeout=&lt;seconds&gt;"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis database connection string <span class="keyword">in</span> the <span class="keyword">case</span> that we are using Redis</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as the user database.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This database can be used <span class="keyword">for</span> long-term and short-term credential mechanisms</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and it can store the secret value <span class="keyword">for</span> secret-based timed authentication <span class="keyword">in</span> TURN RESP API.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use string format as below (space separated parameters, all optional):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis数据库连接字符串,使用Redis作为用户数据库。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 该数据库可用于长期和短期证书机制,它可以存储的私密值，为基于私密身份验证的在TURN RESP API中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用字符串格式如下(空间分离参数,所有可选):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">redis-userdb=<span class="string">"ip=&lt;ip-address&gt; dbname=&lt;database-number&gt; password=&lt;database-user-password&gt; port=&lt;port&gt; connect_timeout=&lt;seconds&gt;"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis status and statistics database connection string, <span class="keyword">if</span> used (default - empty, no Redis stats DB used).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This database keeps allocations status information, and it can be also used <span class="keyword">for</span> publishing</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and delivering traffic and allocation event notifications.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The connection string has the same parameters as redis-userdb connection string.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use string format as below (space separated parameters, all optional):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis状态和统计数据库连接字符串,如果使用(默认空,没有Redis统计数据库使用)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个数据库保持分配状态信息,它也可以用于发布和交付传输和分配事件通知。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 连接字符串有相同的参数作为redis-userdb连接字符串。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用字符串格式如下(空间分离参数,所有可选):</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">redis-statsdb=<span class="string">"ip=&lt;ip-address&gt; dbname=&lt;database-number&gt; password=&lt;database-user-password&gt; port=&lt;port&gt; connect_timeout=&lt;seconds&gt;"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Realm <span class="keyword">for</span> long-term credentials mechanism and <span class="keyword">for</span> TURN REST API.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN REST API的长期凭证机制范围。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">realm=mycompany.org</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Per-user allocation quota.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default value is 0 (no quota, unlimited number of sessions per user).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 每个用户分配配额。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值为0(没有配额,每个用户无限数量的会话)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">user-quota=0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Total allocation quota.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default value is 0 (no quota).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 总分配配额。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值为0(无配额)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">total-quota=0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Max bytes-per-second bandwidth a TURN session is allowed to handle</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (input and output network streams are treated separately). Anything above</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> that <span class="built_in">limit</span> will be dropped or temporary suppressed (within</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the available buffer limits).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TURN会话允许最大的传输占用带宽(输入和输出网络流分别处理)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 高于限制将被删除或暂时抑制(在可用的缓冲区范围内)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">max-bps=0</span></span><br><span class="line">max-bps=1024</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no UDP client listener is desired.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default UDP client listener is always started.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有UDP客户端监听器需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下UDP客户端监听器总是启动。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-udp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no TCP client listener is desired.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default TCP client listener is always started.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有TCPP客户端监听器需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下TCPP客户端监听器总是启动。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tcp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no TLS client listener is desired.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default TLS client listener is always started.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有TLS客户端监听器需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下TLS客户端监听器总是启动。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tls</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no DTLS client listener is desired.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default DTLS client listener is always started.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有DTLS客户端监听器需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下DTLS客户端监听器总是启动。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-dtls</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no UDP relay endpoints are allowed.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default UDP relay endpoints are enabled (like <span class="keyword">in</span> RFC 5766).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果不允许UDP中继端点需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下启用UDP继电器端点(如在RFC 5766)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-udp-relay</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> no TCP relay endpoints are allowed.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default TCP relay endpoints are enabled (like <span class="keyword">in</span> RFC 6062).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果不允许TCP中继端点需要取消。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下启用TCP继电器端点(如在RFC 5766)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tcp-relay</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Uncomment <span class="keyword">if</span> extra security is desired,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> with nonce value having limited lifetime (600 secs).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, the nonce value is unique <span class="keyword">for</span> a session,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> but it has unlimited lifetime. With this option,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the nonce lifetime is limited to 600 seconds, after that</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the client will get 438 error and will have to re-authenticate itself.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 取消如果需要额外的安全,现时已有有限的生命周期(600秒)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,一个会话的唯一临界值,但它一般拥有无限的生命周期。这个选项,临界值</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 仅限于600秒,之后,客户端将得到438错误,将不得不重新认证。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">stale-nonce</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Certificate file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use an absolute path or path relative to the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> configuration file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 证书文件。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用绝对路径或路径相对于配置文件。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">cert=/etc/cacert.pem</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Private key file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use an absolute path or path relative to the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> configuration file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use PEM file format.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 私钥文件。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用绝对路径或路径相对于配置文件。使用PEM文件格式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">pkey=/etc/cakey.pem</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Private key file password, <span class="keyword">if</span> it is <span class="keyword">in</span> encoded format.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option has no default value.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 私有密钥文件密码,如果是在编码格式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项没有默认值。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">pkey-pwd=...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Allowed OpenSSL cipher list <span class="keyword">for</span> TLS/DTLS connections.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default value is <span class="string">"DEFAULT"</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许OpenSSL的密码列表为TLS/DTLS连接。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值是<span class="string">"DEFAULT"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cipher-list=<span class="string">"DEFAULT"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> CA file <span class="keyword">in</span> OpenSSL format.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Forces TURN server to verify the client SSL certificates.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default it is not <span class="built_in">set</span>: there is no default value and the client</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> certificate is not checked.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在OpenSSL格式的CA文件。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 强制TURN服务器验证客户端SSL证书。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下它没有设置:没有默认值,不检查的客户端证书。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">CA-file=/etc/ca11111.crt</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Curve name <span class="keyword">for</span> EC ciphers, <span class="keyword">if</span> supported by OpenSSL library (TLS and DTLS).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default value is prime256v1.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 曲线名称的EC密码,如果由OpenSSL库支持(TLS和DTLS)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值是prime256v1。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">ec-curve-name=prime256v1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use 566 bits predefined DH TLS key. Default size of the key is 1066.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用566位预定义DH TLS键。默认键大小是1066</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">dh566</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use 2066 bits predefined DH TLS key. Default size of the key is 1066.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用2066位预定义DH TLS键。默认键大小是1066</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">dh2066</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Use custom DH TLS key, stored <span class="keyword">in</span> PEM format <span class="keyword">in</span> the file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Flags --dh566 and --dh2066 are ignored when the DH key is taken from a file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用惯例的DH TLS键，使用PEM格式存储在文件里</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当DH键从文件里加载，将忽略标志--dh566和--dh2066</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">dh-file=&lt;DH-PEM-file-name&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Flag to prevent stdout <span class="built_in">log</span> messages.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, all <span class="built_in">log</span> messages are going to both stdout and to</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the configured <span class="built_in">log</span> file. With this option everything will be</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> going to the configured <span class="built_in">log</span> only (unless the <span class="built_in">log</span> file itself is stdout).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 标志防止输出日志信息</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,所有日志消息将输出到配置的日志文件。采用这一选项都将只配置日志</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (除非日志文件本身是输出的)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-stdout-log</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to <span class="built_in">set</span> the <span class="built_in">log</span> file name.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, the turnserver tries to open a <span class="built_in">log</span> file <span class="keyword">in</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> /var/<span class="built_in">log</span>, /var/tmp, /tmp and current directories directories</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (<span class="built_in">which</span> open operation succeeds first that file will be used).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> With this option you can <span class="built_in">set</span> the definite <span class="built_in">log</span> file name.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The special names are <span class="string">"stdout"</span> and <span class="string">"-"</span> - they will force everything</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> to the stdout. Also, the <span class="string">"syslog"</span> name will force everything to</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the system <span class="built_in">log</span> (syslog).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In the runtime, the logfile can be reset with the SIGHUP signal</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> to the turnserver process.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置日志文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,turnserver尝试一个日志文件在/var/<span class="built_in">log</span>,/var/tmp,/tmp和</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当前目录(那个文件先打开成功,文件将被使用)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 采用这一选项可以设置明确的日志文件名。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 特殊的名字是<span class="string">"stdout"</span>和<span class="string">"-"</span>——他们将强制所有的输出。同时,<span class="string">"syslog"</span>名称将强制所有的系统日志(syslog)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在运行时,日志文件可以重置通过SIGHUP信号在turnserver程序中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">log</span>-file=/var/tmp/turn.log</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to redirect all <span class="built_in">log</span> output into system <span class="built_in">log</span> (syslog).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择重定向所有日志输出到系统日志(syslog)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">syslog</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This flag means that no <span class="built_in">log</span> file rollover will be used, and the <span class="built_in">log</span> file</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> name will be constructed as-is, without PID and date appendage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个标志意味着没有日志文件将使用翻转,并按原样将创建日志文件名称,没有PID和日期的附加。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">simple-log</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to <span class="built_in">set</span> the <span class="string">"redirection"</span> mode. The value of this option</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> will be the address of the alternate server <span class="keyword">for</span> UDP &amp; TCP service <span class="keyword">in</span> form of</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;ip&gt;[:&lt;port&gt;]. The server will send this value <span class="keyword">in</span> the attribute</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ALTERNATE-SERVER, with error 300, on ALLOCATE request, to the client.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Client will receive only values with the same address family</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> as the client network endpoint address family.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See RFC 5389 and RFC 5766 <span class="keyword">for</span> ALTERNATE-SERVER functionality description.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The client must use the obtained value <span class="keyword">for</span> subsequent TURN communications.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If more than one --alternate-server options are provided, <span class="keyword">then</span> the functionality</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> can be more accurately described as <span class="string">"load-balancing"</span> than a mere <span class="string">"redirection"</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If the port number is omitted, <span class="keyword">then</span> the default port</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> number 3478 <span class="keyword">for</span> the UDP/TCP protocols will be used.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Colon ( characters <span class="keyword">in</span> IPv6 addresses may conflict with the syntax of</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the option. To alleviate this conflict, literal IPv6 addresses are enclosed</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span> square brackets <span class="keyword">in</span> such resource identifiers, <span class="keyword">for</span> example:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> [2001:db8:85a3:8d3:1319:8a2e:370:7348]:3478 .</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Multiple alternate servers can be <span class="built_in">set</span>. They will be used <span class="keyword">in</span> the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> round-robin manner. All servers <span class="keyword">in</span> the pool are considered of equal weight and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the load will be distributed equally. For example, <span class="keyword">if</span> we have 4 alternate servers,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">then</span> each server will receive 25% of ALLOCATE requests. A alternate TURN server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> address can be used more than one time with the alternate-server option, so this</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> can <span class="built_in">emulate</span> <span class="string">"weighting"</span> of the servers.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选项设置<span class="string">"redirection"</span>模式。这个选项的值将备用服务器的地址UDP和TCP服务形式的&lt;ip&gt;[:&lt;port&gt;]。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务器将发送这个值属性ALTERNATE-SERVER,错误300,在ALLOCATE请求,客户端。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端将只接收和自己相同的地址族的客户端的值。查看RFC 5389和RFC 5766为ALTERNATE-SERVER的功能描述。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端必须使用获得的值为随后的TURN通信。如果不止一个——alternate-server选项提供,那么功能可以更准确</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 地描述为<span class="string">"load-balancing"</span>,而不仅仅是一个<span class="string">"redirection"</span>。如果端口号省略,那么为UDP/TCP协议，使用默认端</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 口号是3478。冒号(在IPv6地址字符可能与选项的语法冲突。缓解这种冲突,文字IPv6地址包含在方括号在这种</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源标识符,例如[2001:db8:85a3:8d3:1319:8a2e:370:7348]:3478 。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以设置多个备用服务器。他们将用于循环的方式。所有服务器池中被认为是平等的重量和载荷将平均分配的原则。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 例如,如果我们有4个备用服务器,每个服务器将获得25%的分配请求。备用TURN服务器地址可以使用超过一次</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> alternate-server选项,所以这可以效仿的<span class="string">"weighting"</span>服务器。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Examples:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">alternate-server=1.2.3.4:5678</span></span><br><span class="line"><span class="meta">#</span><span class="bash">alternate-server=11.22.33.44:56789</span></span><br><span class="line"><span class="meta">#</span><span class="bash">alternate-server=5.6.7.8</span></span><br><span class="line"><span class="meta">#</span><span class="bash">alternate-server=[2001:db8:85a3:8d3:1319:8a2e:370:7348]:3478</span></span><br><span class="line">              </span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to <span class="built_in">set</span> alternative server <span class="keyword">for</span> TLS &amp; DTLS services <span class="keyword">in</span> form of</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;ip&gt;:&lt;port&gt;. If the port number is omitted, <span class="keyword">then</span> the default port</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> number 5349 <span class="keyword">for</span> the TLS/DTLS protocols will be used. See the previous</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> option <span class="keyword">for</span> the functionality description.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选项设置替代服务器TLS和DTLS服务形式的&lt;ip&gt;:&lt;port&gt;。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果省略的端口号,那么默认端口号5349将使用TLS/DTLS协议。看到前面选择的功能描述。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Examples:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tls-alternate-server=1.2.3.4:5678</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tls-alternate-server=11.22.33.44:56789</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tls-alternate-server=[2001:db8:85a3:8d3:1319:8a2e:370:7348]:3478</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to suppress TURN functionality, only STUN requests will be processed.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Run as STUN server only, all TURN requests will be ignored.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, this option is NOT <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择抑制TURN功能,只有STUN的请求将被处理。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 作为STUN服务器,所有TURN请求将被忽略。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,没有设置这个选项。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">stun-only</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to suppress STUN functionality, only TURN requests will be processed.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Run as TURN server only, all STUN requests will be ignored.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, this option is NOT <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择抑制STUN功能,只有TURN的请求将被处理。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 作为TURN服务器,所有STUN请求将被忽略。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,没有设置这个选项。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-stun</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the timestamp/username separator symbol (character) <span class="keyword">in</span> TURN REST API.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default value is <span class="string">':'</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是时间戳/用户名分离器符号(字符)在TURN REST API。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认是使用<span class="string">':'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rest-api-separator=:    </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Flag that can be used to disallow peers on the loopback addresses (127.x.x.x and ::1).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is an extra security measure.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 标记用于不接受的端在环回地址(127.x.x.x 和 ::1)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是一个额外的安全措施。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-loopback-peers</span></span><br><span class="line">172.26.7.151</span><br><span class="line"><span class="meta">#</span><span class="bash"> Flag that can be used to disallow peers on well-known broadcast addresses (224.0.0.0 and above, and FFXX:*).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is an extra security measure.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 标记用于不接受的端在广播地址(224.0.0.0和以上的，和FFXX:*)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是一个额外的安全措施。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-multicast-peers</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to <span class="built_in">set</span> the max time, <span class="keyword">in</span> seconds, allowed <span class="keyword">for</span> full allocation establishment.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default is 60 seconds.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选项设置的最大时间,以秒为单位,允许完整的分配。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认60秒</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">max-allocate-timeout=60</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Option to allow or ban specific ip addresses or ranges of ip addresses.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If an ip address is specified as both allowed and denied, <span class="keyword">then</span> the ip address is</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> considered to be allowed. This is useful when you wish to ban a range of ip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> addresses, except <span class="keyword">for</span> a few specific ips within that range.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This can be used when you <span class="keyword">do</span> not want users of the turn server to be able to access</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> machines reachable by the turn server, but would otherwise be unreachable from the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> internet (e.g. when the turn server is sitting behind a NAT)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择允许或禁止特定的ip地址或ip地址范围。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果指定一个ip地址允许和拒绝,那么ip地址被认为是允许的。这是有用的,当你希望禁止一个范</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 围的ip地址,除了一些特定的ip范围内。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这可以使用当你不希望turn服务器的用户能够访问机器通过turn服务器,但可能是另一方面从互联</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 网上不能到达(例如,当turn服务器是在一个NAT后)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Examples:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> denied-peer-ip=83.166.64.0-83.166.95.255</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> allowed-peer-ip=83.166.68.45</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> File name to store the pid of the process.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default is /var/run/turnserver.pid (<span class="keyword">if</span> superuser account is used) or</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> /var/tmp/turnserver.pid .</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 存储进程pid的文件名。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认是/var/run/turnserver.pid(超级用户使用)或者是/var/tmp/turnserver.pid</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">pidfile=<span class="string">"/var/run/turnserver.pid"</span></span></span><br><span class="line">pidfile="/var/tmp/turnserver.pid"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Require authentication of the STUN Binding request.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, the clients are allowed anonymous access to the STUN Binding functionality.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要STUN绑定请求的身份验证。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,客户允许匿名访问STUN绑定功能。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">secure-stun</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Require SHA256 digest <span class="keyword">function</span> to be used <span class="keyword">for</span> the message integrity.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default, the server uses SHA1 (as per TURN standard specs).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> With this option, the server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> always requires the stronger SHA256 <span class="keyword">function</span>. The client application</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> must support SHA256 <span class="built_in">hash</span> <span class="keyword">function</span> <span class="keyword">if</span> this option is used. If the server obtains</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> a message from the client with a weaker (SHA1) <span class="built_in">hash</span> <span class="keyword">function</span> <span class="keyword">then</span> the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> server returns error code 426.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要SHA256采摘功能用于消息的完整性。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下,服务器使用SHA1(按标准规格)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 采用这一选项,服务器总是需要更强的SHA256功能。客户端应用程序必须支持SHA256散列函数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果使用这个选项。如果服务器获得消息从客户端较弱(SHA1)散列函数那么服务器返回错误代码426。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">sha256</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Mobility with ICE (MICE) specs support.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 移动的ICE(MICE)的规范支持。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">mobility</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> User name to run the process. After the initialization, the turnserver process</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> will make an attempt to change the current user ID to that user.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户名运行程序。初始化后,turnserver程序将试图改变当前用户的用户ID。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">proc-user=&lt;user-name&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Group name to run the process. After the initialization, the turnserver process</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> will make an attempt to change the current group ID to that group.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 组名运行程序。初始化后,turnserver程序将试图改变当前组的组ID。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">proc-group=&lt;group-name&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Turn OFF the CLI support.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default it is always ON.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See also options cli-ip and cli-port.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 关掉CLI的支持。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下它总是ON。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参阅选项cli-ip和cli-port。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-cli</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Local system IP address to be used <span class="keyword">for</span> CLI server endpoint. Default value</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> is 127.0.0.1.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 本地系统的IP地址将用于CLI服务器端点。默认值是127.0.0.1。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cli-ip=127.0.0.1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> CLI server port. Default is 5766.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> CLI服务器端口。默认是5766。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cli-port=5766</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> CLI access password. Default is empty (no password).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> CLI访问密码。默认是空的(没有密码)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">cli-password=logen</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Server relay. NON-STANDARD AND DANGEROUS OPTION.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Only <span class="keyword">for</span> those applications when we want to run</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> server applications on the relay endpoints.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This option eliminates the IP permissions check on</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the packets incoming to the relay endpoints.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 中继服务器。NON-STANDARD和DANGEROUS的选择。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只对这些应用程序时,我们想在中继服务器上运行服务器应用程序端点。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个选项可以消除IP权限检查传递的数据包传入的端点。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">server-relay</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Maximum number of output sessions <span class="keyword">in</span> ps CLI <span class="built_in">command</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This value can be changed on-the-fly <span class="keyword">in</span> CLI. The default value is 256.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 最大数量的输出会议在ps CLI命令。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个值可以动态改变在CLI。默认值是256。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">cli-max-output-sessions</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Set network engine <span class="built_in">type</span> <span class="keyword">for</span> the process (<span class="keyword">for</span> internal purposes).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置网络引擎类型(用于内部目的)的过程。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">ne=[1|2|3]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Do not allow an SSL/TLS version of protocol</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不允许一个SSL/TLS版本的协议</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-sslv2</span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-sslv3</span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tlsv1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tlsv1_1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">no-tlsv1_2%</span></span><br></pre></td></tr></table></figure>

</details>


      
    </div>

    

    
    
    

    <footer class="post-footer">
      

      <div>    
        
        
            <ul class="post-copyright">
            <li class="post-copyright-author">
                <strong>本文作者：</strong>Mr.Miaow
            </li>
            <li class="post-copyright-link">
                <strong>本文链接：</strong>
                <a href="/2019/05/15/WebRTC/webrtc-02/" title="WebRTC（二）">2019/05/15/WebRTC/webrtc-02/</a>
            </li>
            <li class="post-copyright-license">
                <strong>版权： </strong>
                本站文章均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议，请勿用于商业，转载注明出处！
            </li>
            </ul>
        
      </div>
    
      

      
        
      
      
        <div>
          <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
      	<a href="/images/wechatpay.jpg" class="fancybox fancybox.image" rel="group">
          <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Mr.Miaow 微信支付">
	</a>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
      	<a href="/images/alipay.jpg" class="fancybox fancybox.image" rel="group">
          <img id="alipay_qr" src="/images/alipay.jpg" alt="Mr.Miaow 支付宝">
	</a>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

        </div>
      

      
        <div class="post-tags">
          
            <a href="/tags/WebRTC/" rel="tag"> <i class="fa fa-tag"></i> WebRTC</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/14/WebRTC/webrtc-01/" rel="next" title="WebRTC（一）">
                <i class="fa fa-chevron-left"></i> WebRTC（一）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/17/WebRTC/webrtc-03/" rel="prev" title="WebRTC（三）">
                WebRTC（三） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="gitalk-container">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
      
      
        
            <ul class="sidebar-nav motion-element">
                <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
                    文章目录
                </li>
                <li class="sidebar-nav-overview" data-target="site-overview-wrap">
                    站点概览
                </li>
            </ul>
        
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <!-- 添加头像链接 -->
            <a href="/about">
              
                <img class="site-author-image" itemprop="image" src="http://wx4.sinaimg.cn/orj360/e9d04169ly1fde7jy4bquj20ek0hf7gh.jpg" alt="Mr.Miaow">
              
                <p class="site-author-name" itemprop="name">Mr.Miaow</p>
            </a>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">66</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">26</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21pYW9wZWk=" title="GitHub &rarr; https://github.com/miaopei"><i class="fa fa-fw fa-github"></i>GitHub</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/miaopei163@163.com" title="E-Mail &rarr; miaopei163@163.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          <link rel="stylesheet" href="/dist/APlayer.min.css">
          <div id="aplayer"></div>
          <script type="text/javascript" src="/dist/APlayer.min.js"></script>
          <script type="text/javascript" src="/dist/music.js"></script>

          

          
          

          
            
          
          

        </div>
      </div>

      
        
        <!--noindex-->
            <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
                <div class="post-toc">

                
                    
                

                
                    <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#端对端1V1传输基本流程"><span class="nav-number">1.</span> <span class="nav-text">端对端1V1传输基本流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#媒体能力协商过程"><span class="nav-number">1.1.</span> <span class="nav-text">媒体能力协商过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-连接的基本流程"><span class="nav-number">1.2.</span> <span class="nav-text">1:1 连接的基本流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【实战】WebRTC-视频传输"><span class="nav-number">1.3.</span> <span class="nav-text">【实战】WebRTC 视频传输</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【实战】显示通讯双方的-SDP-内容"><span class="nav-number">1.4.</span> <span class="nav-text">【实战】显示通讯双方的 SDP 内容</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebRTC核心之SDP详解"><span class="nav-number">2.</span> <span class="nav-text">WebRTC核心之SDP详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#【协议规范】SDP-规范"><span class="nav-number">2.1.</span> <span class="nav-text">【协议规范】SDP 规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【协议规范】WebRTC-中的-SDP"><span class="nav-number">2.2.</span> <span class="nav-text">【协议规范】WebRTC 中的 SDP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【详解】WebRTC-中-Offer-Answer-SDP"><span class="nav-number">2.3.</span> <span class="nav-text">【详解】WebRTC 中 Offer_Answer SDP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现1V1音视频实时互动直播系统"><span class="nav-number">3.</span> <span class="nav-text">实现1V1音视频实时互动直播系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#STUN-TURN-服务器搭建"><span class="nav-number">3.1.</span> <span class="nav-text">STUN/TURN 服务器搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【参数介绍】再论-RTCPeerConnection"><span class="nav-number">3.2.</span> <span class="nav-text">【参数介绍】再论 RTCPeerConnection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#直播系统中的信令及其逻辑关系"><span class="nav-number">3.3.</span> <span class="nav-text">直播系统中的信令及其逻辑关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现-1：1-音视频实时互动信令服务器"><span class="nav-number">3.4.</span> <span class="nav-text">实现 1：1 音视频实时互动信令服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#再论CreateOffer"><span class="nav-number">3.5.</span> <span class="nav-text">再论CreateOffer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebRTC-客户端状态机及处理逻辑"><span class="nav-number">3.6.</span> <span class="nav-text">WebRTC 客户端状态机及处理逻辑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebRTC-客户端的实现"><span class="nav-number">3.7.</span> <span class="nav-text">WebRTC 客户端的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#共享远程桌面"><span class="nav-number">3.8.</span> <span class="nav-text">共享远程桌面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebRTC核心之RTP媒体控制与数据统计"><span class="nav-number">4.</span> <span class="nav-text">WebRTC核心之RTP媒体控制与数据统计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RTPPReceiver-发送器"><span class="nav-number">4.1.</span> <span class="nav-text">RTPPReceiver 发送器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RTPSender-发送器"><span class="nav-number">4.2.</span> <span class="nav-text">RTPSender 发送器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#传输速率的控制"><span class="nav-number">4.3.</span> <span class="nav-text">传输速率的控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【实战】WebRTC统计信息"><span class="nav-number">4.4.</span> <span class="nav-text">【实战】WebRTC统计信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebRTC非音视频数据传输"><span class="nav-number">5.</span> <span class="nav-text">WebRTC非音视频数据传输</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#传输非音视频数据基础知识"><span class="nav-number">5.1.</span> <span class="nav-text">传输非音视频数据基础知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#端到端文本聊天"><span class="nav-number">5.2.</span> <span class="nav-text">端到端文本聊天</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件实时传输"><span class="nav-number">5.3.</span> <span class="nav-text">文件实时传输</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebRTC实时数据传输网络协议详解"><span class="nav-number">6.</span> <span class="nav-text">WebRTC实时数据传输网络协议详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#【协议规范】RTP-SRTP协议头详解"><span class="nav-number">6.1.</span> <span class="nav-text">【协议规范】RTP-SRTP协议头详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【协议规范】RTCP-中的-SR-与-RR-报文"><span class="nav-number">6.2.</span> <span class="nav-text">【协议规范】RTCP 中的 SR 与 RR 报文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【协议规范】DTSL"><span class="nav-number">6.3.</span> <span class="nav-text">【协议规范】DTSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wireshark-分析-rtp-rtcp-包"><span class="nav-number">6.4.</span> <span class="nav-text">wireshark 分析 rtp-rtcp 包</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android端与浏览器互通"><span class="nav-number">7.</span> <span class="nav-text">Android端与浏览器互通</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Android-与浏览器互通"><span class="nav-number">7.1.</span> <span class="nav-text">Android 与浏览器互通</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebRTCNative-开发逻辑"><span class="nav-number">7.2.</span> <span class="nav-text">WebRTCNative 开发逻辑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实战-权限申请-库的引入与界面"><span class="nav-number">7.3.</span> <span class="nav-text">实战-权限申请-库的引入与界面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实战-通过-socket-io-实现信令收发"><span class="nav-number">7.4.</span> <span class="nav-text">实战-通过 socket.io 实现信令收发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实战-Android-与浏览器互通"><span class="nav-number">7.5.</span> <span class="nav-text">实战-Android 与浏览器互通</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iOS端与浏览器互通"><span class="nav-number">8.</span> <span class="nav-text">iOS端与浏览器互通</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS权限获取"><span class="nav-number">8.1.</span> <span class="nav-text">IOS权限获取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS引入WebRTC库"><span class="nav-number">8.2.</span> <span class="nav-text">IOS引入WebRTC库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS端SocketIO的使用"><span class="nav-number">8.3.</span> <span class="nav-text">IOS端SocketIO的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS界面布局"><span class="nav-number">8.4.</span> <span class="nav-text">IOS界面布局</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS本地视频采集与展示"><span class="nav-number">8.5.</span> <span class="nav-text">IOS本地视频采集与展示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS端RTCPeerConnection"><span class="nav-number">8.6.</span> <span class="nav-text">IOS端RTCPeerConnection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS媒体协商"><span class="nav-number">8.7.</span> <span class="nav-text">IOS媒体协商</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IOS远端视频渲染"><span class="nav-number">8.8.</span> <span class="nav-text">IOS远端视频渲染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#课程总结"><span class="nav-number">9.</span> <span class="nav-text">课程总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#即时通信（IM）和实时通信（RTC）的区别"><span class="nav-number">10.</span> <span class="nav-text">即时通信（IM）和实时通信（RTC）的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#场景"><span class="nav-number">10.1.</span> <span class="nav-text">场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#要求"><span class="nav-number">10.2.</span> <span class="nav-text">要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#技术环节"><span class="nav-number">10.3.</span> <span class="nav-text">技术环节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#传输协议"><span class="nav-number">10.4.</span> <span class="nav-text">传输协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#成本"><span class="nav-number">10.5.</span> <span class="nav-text">成本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可用的解决方案"><span class="nav-number">10.6.</span> <span class="nav-text">可用的解决方案</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">11.</span> <span class="nav-text">Reference</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#socket-io-原理详解"><span class="nav-number">11.1.</span> <span class="nav-text">socket.io 原理详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#音视频数据采集与控制"><span class="nav-number">11.2.</span> <span class="nav-text">音视频数据采集与控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NAT-穿越"><span class="nav-number">11.3.</span> <span class="nav-text">NAT 穿越</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ICE-原理"><span class="nav-number">11.4.</span> <span class="nav-text">ICE 原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#媒体协商过程"><span class="nav-number">11.5.</span> <span class="nav-text">媒体协商过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络处理与流程"><span class="nav-number">11.6.</span> <span class="nav-text">网络处理与流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何实现并规模高并发"><span class="nav-number">11.7.</span> <span class="nav-text">如何实现并规模高并发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何更好的利用网络"><span class="nav-number">11.8.</span> <span class="nav-text">如何更好的利用网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#回音消除与降噪"><span class="nav-number">11.9.</span> <span class="nav-text">回音消除与降噪</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OpenCV"><span class="nav-number">11.10.</span> <span class="nav-text">OpenCV</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OpenGL视频渲染"><span class="nav-number">11.11.</span> <span class="nav-text">OpenGL视频渲染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#问题解决里程"><span class="nav-number">12.</span> <span class="nav-text">问题解决里程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#补充"><span class="nav-number">13.</span> <span class="nav-text">补充</span></a></li></ol></div>
                

                </div>
            </div>
        <!--/noindex-->
        
      


      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2015 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <!--<i class="fa fa-user"></i>-->
    <i class="fa fa-heart" aria-hidden="true" style="color:red"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Miaow</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">1m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">15:33</span>
  

</div>


   <div>
   <span id="sitetime"></span>
   <span id="year" style="display:none">2016</span> 
   <span id="month" style="display:none">12</span>   
   <span id="day" style="display:none">23</span>   
   <span id="hour" style="display:none">15</span>   
   <span id="minute" style="display:none">0</span>   
   <span id="second" style="display:none">0</span>   
	<script language="javascript">
	function siteTime(){        
		window.setTimeout("siteTime()", 1000);
		var seconds = 1000;
		var minutes = seconds * 60;
		var hours = minutes * 60;
		var days = hours * 24;
		var years = days * 365;
		var today = new Date();
		var todayYear = today.getFullYear();
		var todayMonth = today.getMonth()+1;
		var todayDate = today.getDate();
		var todayHour = today.getHours();
		var todayMinute = today.getMinutes();
		var todaySecond = today.getSeconds();
		/* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
		year - 作为date对象的年份，为4位年份值
		month - 0-11之间的整数，做为date对象的月份
		day - 1-31之间的整数，做为date对象的天数
		hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
		minutes - 0-59之间的整数，做为date对象的分钟数
		seconds - 0-59之间的整数，做为date对象的秒数
		microseconds - 0-999之间的整数，做为date对象的毫秒数 */        
		var year = document.getElementById("year").innerHTML;
		var month = document.getElementById("month").innerHTML;
		var day = document.getElementById("day").innerHTML;
		var hour = document.getElementById("hour").innerHTML;
		var minute = document.getElementById("minute").innerHTML;
		var second = document.getElementById("second").innerHTML;//北京时间2018-2-13 00:00:00
		var t1 = Date.UTC(year,month,day,hour,minute,second); 
		var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
		var diff = t2-t1;
		var diffYears = Math.floor(diff/years);
		var diffDays = Math.floor((diff/days)-diffYears*365);
		var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
		var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
		var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
		if(diffYears==0){
		document.getElementById("sitetime").innerHTML=" 网站已运行 "/*+diffYears+" 年 "*/+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
		} else{
		document.getElementById("sitetime").innerHTML=" 网站已运行 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
		}
	}
	//siteTime(document.getElementById("year").innerHTML,document.getElementById("year").innerHTML,document.getElementById("year").innerHTML,document.getElementById("year").innerHTML,document.getElementById("year").innerHTML,0);
	siteTime();
	</script>
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

<!--









-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  



  
    
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>











  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>




  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  
  <script src="/js/exturl.js?v=7.1.1"></script>


  
  
  
    
  

  

  
  
  


  


  
    

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">



<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '8c7770a2f56149bd67f7',
    clientSecret: '1f8bcd6210eaf36b727bcf0546a16cb68dc9012a',
    repo: 'gitment-comments',
    owner: 'miaopei',
    admin: ['miaopei'],
    id: md5(location.pathname),
    
      language: 'zh-CN',
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  

  
<script>
if ($('body').find('pre.mermaid').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      mermaid.initialize({
        theme: 'forest',
        logLevel: 3,
        flowchart: { curve: 'linear' },
        gantt: { axisFormat: '%m/%d/%Y' },
        sequence: { actorMargin: 50 }
      });
    }
  });
}
</script>


  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  
  
  
  <script src="/lib/pangu/dist/pangu.min.js?v=3.3"></script>
  <script>pangu.spacingPage();</script>


  

  
<script>
  $('.highlight').not('.gist .highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

  
  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/love.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src>
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
